(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    121390,       2830]
NotebookOptionsPosition[    118660,       2772]
NotebookOutlinePosition[    119044,       2789]
CellTagsIndexPosition[    119001,       2786]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"CloudConnect", "[", "]"}]], "Input",
 CellChangeTimes->{{3.77705473925775*^9, 3.77705475551768*^9}},
 CellLabel->
  "In[1289]:=",ExpressionUUID->"003d715c-a79f-4b7a-9c93-c3c61350de14"],

Cell[BoxData["\<\"wenqiang_fang@brown.edu\"\>"], "Output",
 CellChangeTimes->{{3.777054744228034*^9, 3.777054772633659*^9}, 
   3.777205171407761*^9, 3.7772259099087*^9, 3.7774855629810123`*^9, 
   3.779150313379326*^9},
 CellLabel->
  "Out[1289]=",ExpressionUUID->"54de4ce0-8551-4c62-b745-7bdd05b4117d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["$CloudConnected"], "Input",
 CellChangeTimes->{{3.7770547836802907`*^9, 3.777054789000595*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"1aca87b8-a358-400b-a77a-afcee46266ae"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.7770547894626217`*^9, 3.777133552798226*^9, 3.7772051814488897`*^9, 
   3.777205546527849*^9, 3.777221485499776*^9, {3.7772257630311937`*^9, 
   3.777225764059568*^9}, 3.777225904279503*^9, 3.7772342505455227`*^9, 
   3.777306402821253*^9, 3.777485564628624*^9, {3.779150315420507*^9, 
   3.779150340322329*^9}, 3.779151345347267*^9, 3.779152048356834*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"ac558873-8f90-41f1-8d5b-0f1d53ceb299"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["$CloudCreditsAvailable"], "Input",
 CellChangeTimes->{{3.777205187357815*^9, 3.777205204233698*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"47921a87-878e-489c-a894-d4b505ec15a9"],

Cell[BoxData["34968"], "Output",
 CellChangeTimes->{
  3.777205205492358*^9, 3.77720554600485*^9, 3.777221488307703*^9, {
   3.779150318899581*^9, 3.779150342826249*^9}, 3.779152051107581*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"b49e42ba-33b0-4fa3-9c9b-0379fcd196a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full version Sep 13, 2019\t", "Section",
 CellChangeTimes->{{3.7772056225936003`*^9, 3.777205673975136*^9}, {
  3.777405513947266*^9, 
  3.7774055281692123`*^9}},ExpressionUUID->"bccfd88a-5f22-490f-8dea-\
d1cc1ddd9b96"],

Cell[CellGroupData[{

Cell["Subroutines", "Subsection",
 CellChangeTimes->{{3.7774055325207653`*^9, 
  3.777405536964876*^9}},ExpressionUUID->"541c662f-363c-42fe-a9b2-\
488d5947384e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"covMesh", "[", 
    RowBox[{"id_Integer", ",", "TwoIStack_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"img", ",", "img1", ",", "img2", ",", "img3", ",", "img4", ",", 
       RowBox[{"f", "=", 
        RowBox[{
         RowBox[{"EdgeDetect", "[", 
          RowBox[{"#", ",", "d"}], "]"}], " ", "&"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"img", "=", 
       RowBox[{"TwoIStack", "[", 
        RowBox[{"[", "id", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"img1", "=", 
       RowBox[{"Blur", "[", 
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"img", ",", "0.05"}], "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"img2", "=", 
       RowBox[{"f", "[", 
        RowBox[{"DeleteSmallComponents", "[", "img1", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"img3", "=", 
       RowBox[{"PixelValuePositions", "[", 
        RowBox[{"img2", ",", "1", ",", "0.1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"img4", "=", 
       RowBox[{"ConvexHullMesh", "[", "img3", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "id", ",", "img", ",", "img1", ",", "img2", ",", "img3", ",", "img4"}],
        "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GetPointCloud", "[", 
    RowBox[{"xd_", ",", "yd_", ",", "zd_", ",", "dir_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "imgs1", ",", "imgs", ",", "data", ",", "data2", ",", "data3", ",", 
       "data4", ",", "data5", ",", "ids", ",", "ThreeDPoints", ",", "p1", ",",
        "pltThreeDPoints"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"imgs1", "=", 
       RowBox[{"CloudObjects", "[", "dir", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imgs", " ", "=", 
       RowBox[{"CloudImport", "/@", "imgs1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"covMesh", "[", 
          RowBox[{"#", ",", "imgs", ",", "10"}], "]"}], "&"}], " ", "/@", " ", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "@", "imgs"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data2", "=", 
       RowBox[{"data", "/.", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "ii_Integer", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", 
           "g_BoundaryMeshRegion"}], "}"}], "\[Rule]", 
         RowBox[{"f", "[", 
          RowBox[{"ii", ",", "g"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"data3", "=", 
       RowBox[{"data2", "/.", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x___", ",", 
           RowBox[{"Longest", "[", 
            RowBox[{"y", ":", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"_", ",", "_"}], "]"}], ".."}]}], "]"}], ",", "z___"}],
           "}"}], "\[Rule]", 
         RowBox[{"List", "[", "y", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"data4", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"List", ",", "data3", ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ids", "=", 
       RowBox[{"data4", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"data5", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", "ids", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ThreeDPoints", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"ThreeDPoints", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"data5", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "5", ",", "j", ",", "1"}], "]"}], "]"}], 
               " ", "xd"}], ",", 
              RowBox[{
               RowBox[{"data5", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "5", ",", "j", ",", "2"}], "]"}], "]"}], 
               " ", "yd"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"data5", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "zd"}]}], 
             "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"data5", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "5"}], "]"}], "]"}]}]}], "}"}]}], "]"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "data5"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p1", " ", "=", " ", 
       RowBox[{"Mean", "[", "ThreeDPoints", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pltThreeDPoints", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"p", "-", "p1"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "ThreeDPoints"}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FitSphere", "[", "PC_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fitset1", ",", "PC1", ",", "PC2", ",", "rofun1", ",", "r1"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fitset1", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"SphericalHarmonicY", "[", 
           RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"-", "2"}], ",", "2", ",", "1"}], "}"}]}], "]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"PC1", "=", 
       RowBox[{"CoordinateTransform", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", 
           "3"}], "}"}], ",", "PC"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PC2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "PC1"}], "}"}]}], "]"}]}], ";", "\n", "       ", 
      RowBox[{
       RowBox[{"rofun1", "[", 
        RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], " ", "=", " ", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Fit", "[", 
            RowBox[{"PC2", ",", "fitset1", ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}], "//", 
           "ExpToTrig"}], "//", "TrigReduce"}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r1", " ", "=", 
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"List", "@@", 
           RowBox[{"Simplify", "[", 
            RowBox[{"rofun1", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FitDeformed", "[", "PC_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fitset1", ",", "PC1", ",", "PC2", ",", "rofun2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fitset1", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"SphericalHarmonicY", "[", 
           RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "0", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"-", "2"}], ",", "2", ",", "1"}], "}"}]}], "]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"PC1", "=", 
       RowBox[{"CoordinateTransform", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", 
           "3"}], "}"}], ",", "PC"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PC2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "PC1"}], "}"}]}], "]"}]}], ";", "\n", "       ", 
      RowBox[{"rofun2", " ", "=", "  ", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Fit", "[", 
             RowBox[{"PC2", ",", "fitset1", ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}], "//", 
            "ExpToTrig"}], "//", "Expand"}], "//", "TrigReduce"}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ComputeVol2", "[", "shape_", "]"}], " ", ":=", " ", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["shape", "3"], 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "3"], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotFitting", "[", 
    RowBox[{"surf_", ",", "points_", ",", "str_"}], "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{"surf", ",", "points", ",", 
     RowBox[{"BoxRatios", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"StringTake", "[", 
       RowBox[{"str", ",", 
        RowBox[{"4", ";;"}]}], "]"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", "20"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"5.0", ",", " ", "2.4", ",", " ", "2."}], "}"}]}], ",", 
     RowBox[{"ViewAngle", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
     RowBox[{"SphericalRegion", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.7772212306283407`*^9, {3.7772212790657387`*^9, 3.777221285037827*^9}, {
   3.777221360148245*^9, 3.7772213934349422`*^9}, {3.777225555671623*^9, 
   3.777225559287475*^9}, {3.777317809255889*^9, 3.777317835010441*^9}, 
   3.777320148393285*^9, {3.777320259573661*^9, 3.7773202791545877`*^9}, 
   3.777320488794653*^9, 3.777320540856626*^9, {3.777320762203196*^9, 
   3.777320762449278*^9}, {3.777321425947147*^9, 3.7773214263228703`*^9}, {
   3.777321527048522*^9, 3.7773215274849377`*^9}, {3.777322202348584*^9, 
   3.7773223477027407`*^9}, {3.7773224219411783`*^9, 3.777322438228956*^9}, 
   3.7773369949513407`*^9, {3.777548361538313*^9, 3.777548366588513*^9}, 
   3.7775485475464973`*^9, {3.777551326528316*^9, 3.777551326696303*^9}, {
   3.7775521547834597`*^9, 3.7775521621272087`*^9}},
 CellLabel->
  "(L2) In[182]:=",ExpressionUUID->"5e739396-8407-44d4-8342-81db78a5f878"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"stress3D", "::", "usage"}], "=", 
   "\"\<stress3D[{u,v,w},{Y,\[Nu]}] determines interpolation functions for \
stress from the interpolation functions {u,v,w} for displacement in each \
direction. {Y,\[Nu]} are the modulus of elasticity and Poission ratio.\n      \
The output is a list of the three normal stress components, three shear \
stresses and finally the von Mises stress\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"stress3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "uif_InterpolatingFunction", ",", "vif_InterpolatingFunction", ",", 
       "wif_InterpolatingFunction"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Y_", ",", "\[Nu]_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dd", ",", "df", ",", "mesh", ",", "coords", ",", "dv", ",", "u1", ",", 
       "u2", ",", "u3", ",", "v1", ",", "v2", ",", "v3", ",", "w1", ",", "w2",
        ",", "w3", ",", "g12", ",", "g13", ",", "g23", ",", "c1", ",", "c2", 
       ",", "c3", ",", "\[Sigma]11", ",", "\[Sigma]22", ",", "\[Sigma]33", 
       ",", "\[Sigma]12", ",", "\[Sigma]23", ",", "\[Sigma]31", ",", 
       "\[Sigma]VM"}], "}"}], ",", 
     RowBox[{
      RowBox[{"dd", "=", 
       RowBox[{"Outer", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"#1", "[", 
              RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "#2"}], "]"}], 
           ")"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"uif", ",", "vif", ",", "wif"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "make", " ", "derivative", " ", "interpolation", " ", "functions"}], 
       "*)"}], 
      RowBox[{"df", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"dd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "make", " ", "functions", " ", "for", " ", "each", " ", "derivative"}],
        "*)"}], 
      RowBox[{"mesh", "=", 
       RowBox[{
        RowBox[{"uif", "[", "\"\<Coordinates\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"extract", " ", "coordinates", " ", "from", " ", "mesh"}], 
       "*)"}], 
      RowBox[{"coords", "=", 
       RowBox[{"mesh", "[", "\"\<Coordinates\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dv", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"df", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "@@@", "coords"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "get", " ", "values", " ", "of", " ", "derivatives", " ", "at", " ", 
        "each", " ", "node"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"u1", "=", 
       RowBox[{"dv", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "extract", " ", "individual", " ", "strain", " ", "components"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"u2", "=", 
       RowBox[{"dv", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u3", "=", 
       RowBox[{"dv", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"dv", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"dv", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v3", "=", 
       RowBox[{"dv", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w1", "=", 
       RowBox[{"dv", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w2", "=", 
       RowBox[{"dv", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w3", "=", 
       RowBox[{"dv", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g12", "=", 
       RowBox[{"(", 
        RowBox[{"u2", "+", "v1"}], ")"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"shear", " ", "strains"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"g13", "=", 
       RowBox[{"(", 
        RowBox[{"u3", "+", "w1"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g23", "=", 
       RowBox[{"(", 
        RowBox[{"v3", "+", "w2"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c1", "=", 
       RowBox[{"Y", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[Nu]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Nu]"}], ")"}]}], ")"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Constitutive", " ", "constants"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"c2", "=", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Nu]"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c3", "=", 
       RowBox[{"Y", "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Nu]"}], ")"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]11", "=", 
       RowBox[{"c1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c2", " ", "u1"}], "+", 
          RowBox[{"\[Nu]", " ", "v2"}], "+", 
          RowBox[{"\[Nu]", " ", "w3"}]}], ")"}]}]}], ";", 
      RowBox[{"(*", "stresses", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]22", "=", 
       RowBox[{"c1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Nu]", " ", "u1"}], "+", 
          RowBox[{"c2", " ", "v2"}], "+", 
          RowBox[{"\[Nu]", " ", "w3"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]33", "=", 
       RowBox[{"c1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Nu]", " ", "u1"}], "+", 
          RowBox[{"\[Nu]", " ", "v2"}], "+", 
          RowBox[{"c2", " ", "w3"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]12", "=", 
       RowBox[{"c3", " ", "g12"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"shear", " ", "stresses"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]23", "=", 
       RowBox[{"c3", " ", "g23"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]31", "=", 
       RowBox[{"c3", " ", "g13"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]VM", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Sigma]11", "-", "\[Sigma]22"}], ")"}], "^", "2"}], 
           "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Sigma]22", "-", "\[Sigma]33"}], ")"}], "^", "2"}], 
           "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Sigma]33", "-", "\[Sigma]11"}], ")"}], "^", "2"}], 
           "+", 
           RowBox[{"6", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Sigma]12", "^", "2"}], "+", 
              RowBox[{"\[Sigma]23", "^", "2"}], "+", 
              RowBox[{"\[Sigma]31", "^", "2"}]}], ")"}]}]}], ")"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ElementMeshInterpolation", "[", 
         RowBox[{
          RowBox[{"{", "mesh", "}"}], ",", "\[Sigma]11"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ElementMeshInterpolation", "[", 
         RowBox[{
          RowBox[{"{", "mesh", "}"}], ",", "\[Sigma]22"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ElementMeshInterpolation", "[", 
         RowBox[{
          RowBox[{"{", "mesh", "}"}], ",", "\[Sigma]33"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ElementMeshInterpolation", "[", 
         RowBox[{
          RowBox[{"{", "mesh", "}"}], ",", "\[Sigma]12"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ElementMeshInterpolation", "[", 
         RowBox[{
          RowBox[{"{", "mesh", "}"}], ",", "\[Sigma]23"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ElementMeshInterpolation", "[", 
         RowBox[{
          RowBox[{"{", "mesh", "}"}], ",", "\[Sigma]31"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ElementMeshInterpolation", "[", 
         RowBox[{
          RowBox[{"{", "mesh", "}"}], ",", "\[Sigma]VM"}], "]"}]}], "}"}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dmin", "[", 
   RowBox[{"\[CapitalTheta]_", ",", "\[CapitalPhi]_", ",", "d_", ",", "X_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "Xlocal", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xlocal", "=", 
      RowBox[{"X", "[", 
       RowBox[{"\[CapitalTheta]", ",", "\[CapitalPhi]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FindMinimum", "[", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"\[Xi]", ",", "\[Eta]", ",", "Xlocal"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Xi]", ",", "\[CapitalTheta]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Eta]", ",", "\[CapitalPhi]"}], "}"}]}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<InteriorPoint\>\""}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppDispVec", "[", 
    RowBox[{
     RowBox[{"X1", ":", "_"}], ",", 
     RowBox[{"X2", ":", "_"}], ",", 
     RowBox[{"X3", ":", "_"}], ",", "d_", ",", "X_", ",", "rofun2_"}], "]"}], 
   ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x1", ",", "x2", ",", "x3", ",", "\[CapitalTheta]", ",", 
       "\[CapitalPhi]", ",", "\[CapitalTheta]def", ",", "\[CapitalPhi]def", 
       ",", "rlocal"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rlocal", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}], 
        "}"}], "=", 
       RowBox[{"CoordinateTransformData", "[", 
        RowBox[{
         RowBox[{"\"\<Cartesian\>\"", "\[Rule]", "\"\<Spherical\>\""}], ",", 
         "\"\<Mapping\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"X1", ",", "X2", ",", "X3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CapitalTheta]def", ",", "\[CapitalPhi]def"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "/.", 
        RowBox[{
         RowBox[{"dmin", "[", 
          RowBox[{
          "\[CapitalTheta]", ",", "\[CapitalPhi]", ",", "d", ",", "X"}], 
          "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x1", "=", 
       RowBox[{
        RowBox[{"rofun2", "[", 
         RowBox[{"\[CapitalTheta]def", ",", "\[CapitalPhi]def"}], "]"}], 
        RowBox[{"Sin", "[", "\[CapitalTheta]def", "]"}], 
        RowBox[{"Cos", "[", "\[CapitalPhi]def", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x2", "=", 
       RowBox[{
        RowBox[{"rofun2", "[", 
         RowBox[{"\[CapitalTheta]def", ",", "\[CapitalPhi]def"}], "]"}], 
        RowBox[{"Sin", "[", "\[CapitalTheta]def", "]"}], 
        RowBox[{"Sin", "[", "\[CapitalPhi]def", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x3", "=", 
       RowBox[{
        RowBox[{"rofun2", "[", 
         RowBox[{"\[CapitalTheta]def", ",", "\[CapitalPhi]def"}], "]"}], 
        RowBox[{"Cos", "[", "\[CapitalTheta]def", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1", "-", "X1"}], ",", 
        RowBox[{"x2", "-", "X2"}], ",", 
        RowBox[{"x3", "-", "X3"}]}], "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"InitializeFEM", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Y", " ", "=", 
       RowBox[{"2.62", "\[Times]", 
        SuperscriptBox["10", 
         RowBox[{"-", "4"}]]}]}], " ", ";", " ", 
      RowBox[{"\[Nu]", "=", "0.443"}], ";", "\[IndentingNewLine]", " ", 
      RowBox[{"Xorg1", "=", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], ";", "  ", 
      RowBox[{"Xorg2", "=", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], ";", " ", 
      RowBox[{"Xorg3", "=", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"c11", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"2", "\[Mu]"}]}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Mu]", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "\[Mu]"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c12", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Lambda]", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c13", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "\[Lambda]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c21", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Mu]", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Lambda]", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c22", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"2", "\[Mu]"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "\[Mu]"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c23", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "\[Lambda]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Mu]", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c31", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "\[Mu]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Lambda]", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c32", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "\[Mu]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Lambda]", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c33", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Mu]", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"2", "\[Mu]"}]}]}], "}"}]}], "}"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FEMResult", "[", 
   RowBox[{"Str_", ",", "r1_", ",", "rofun_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rofun3", ",", "RadCell", ",", "r", ",", "\[CapitalOmega]", ",", "mesh", 
      ",", "coords", ",", "vd", ",", "sd", ",", "methodData", ",", 
      "pdeCoefficients", ",", "R", ",", "d", ",", "X", ",", "valAppDispVec", 
      ",", "AppDispVec1", ",", "AppDispVec2", ",", "AppDispVec3", ",", 
      "\[CapitalGamma]g1", ",", "\[CapitalGamma]g2", ",", "\[CapitalGamma]g3",
       ",", "initBCs", ",", "discreteBCs", ",", "discretePDE", ",", "load", 
      ",", "stiffness", ",", "damping", ",", "mass", ",", "solution", ",", 
      "split", ",", "Un1", ",", "Un2", ",", "Un3", ",", "dmesh", ",", "AMat", 
      ",", "SphericalDisp", ",", "SigmaIdShell", ",", "uIdShell", ",", 
      "rofun2IdShell", ",", "\[Theta]1", " ", ",", "\[Phi]1", ",", "\[Kappa]",
       " ", ",", "\[Mu]1", ",", "s11Shell", ",", "s22Shell", ",", "s33Shell", 
      ",", "prIdShellAvg", ",", "\[Sigma]IdShell", ",", "strain11IdShell", 
      ",", "strain22IdShell", ",", "strain33IdShell", ",", "strain12IdShell", 
      ",", "strain23IdShell", ",", "strain13IdShell", ",", "strainIdShell", 
      ",", "workDensityIdShell", ",", "WorkDoneIdShell", ",", "\[Sigma]11", 
      ",", "\[Sigma]22", ",", "\[Sigma]33", ",", "\[Sigma]12", ",", 
      "\[Sigma]23", ",", "\[Sigma]31", ",", "\[Sigma]VM", ",", "cell2Surface",
       ",", "PltMesh", ",", "PltTraction", ",", "traction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"rofun3", "[", 
       RowBox[{"\[Theta]1_", ",", "\[Phi]1_"}], "]"}], "=", 
      RowBox[{"rofun", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]", "\[Rule]", "\[Theta]1"}], ",", 
         RowBox[{"\[Phi]", "\[Rule]", "\[Phi]1"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RadCell", " ", "=", "r1"}], ";", "   ", 
     RowBox[{"(*", 
      RowBox[{"micron", " ", "meter"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r", " ", "=", " ", "RadCell"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalOmega]", "=", 
      RowBox[{"Sphere", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Xorg1", ",", "Xorg2", ",", "Xorg3"}], "}"}], ",", "r"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mesh", "=", 
      RowBox[{"ToElementMesh", "[", 
       RowBox[{"\[CapitalOmega]", ",", 
        RowBox[{"MaxCellMeasure", "\[Rule]", 
         RowBox[{"10", "r"}]}], ",", 
        RowBox[{"\"\<MeshOrder\>\"", "\[Rule]", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coords", "=", 
      RowBox[{"mesh", "[", "\"\<Coordinates\>\"", "]"}]}], ";", "\n", "     ", 
     RowBox[{"vd", "=", 
      RowBox[{"NDSolve`VariableData", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<DependentVariables\>\"", ",", "\"\<Space\>\""}], "}"}], 
        "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"U1", ",", "U2", ",", "U3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"X1", ",", "X2", ",", "X3"}], "}"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"sd", "=", 
      RowBox[{"NDSolve`SolutionData", "[", 
       RowBox[{"\"\<Space\>\"", "\[Rule]", 
        RowBox[{"ToNumericalRegion", "[", "mesh", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"methodData", "=", 
      RowBox[{"InitializePDEMethodData", "[", 
       RowBox[{"vd", ",", "sd"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]", "=", 
          FractionBox[
           RowBox[{"Y", " ", "\[Nu]"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Nu]"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", "\[Nu]"}]}], ")"}]}]]}], ",", 
         RowBox[{"\[Mu]", "=", 
          FractionBox[
           RowBox[{"Y", " "}], 
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Nu]"}], ")"}]}]]}]}], "}"}], ",", 
       RowBox[{"pdeCoefficients", "=", 
        RowBox[{"InitializePDECoefficients", "[", 
         RowBox[{"vd", ",", "sd", ",", 
          RowBox[{"\"\<DiffusionCoefficients\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"c11", ",", "c12", ",", "c13"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"c21", ",", "c22", ",", "c23"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"c31", ",", "c32", ",", "c33"}], "}"}]}], "}"}]}]}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", "RadCell"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"\[Theta]_", ",", "\[Phi]_", ",", "X_"}], "]"}], ":=", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"X", "-", 
         RowBox[{
          RowBox[{"rofun3", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", "\[Theta]", "]"}], 
             RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Theta]", "]"}], 
             RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}]}], ",", "2"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"\[CapitalTheta]_", ",", "\[CapitalPhi]_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"\[CapitalTheta]", ",", "\[CapitalPhi]"}], "]"}], 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "\[CapitalTheta]", "]"}], 
          RowBox[{"Cos", "[", "\[CapitalPhi]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[CapitalTheta]", "]"}], 
          RowBox[{"Sin", "[", "\[CapitalPhi]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[CapitalTheta]", "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"valAppDispVec", " ", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AppDispVec", "[", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", "1"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", "2"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", "3"}], "]"}], ",", "d", ",", "X", ",", 
           "rofun3"}], "]"}], "&"}], ",", "coords"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"valAppDispVec", " ", "=", 
        RowBox[{"ParallelMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AppDispVec", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"#", ",", "1"}], "]"}], ",", 
             RowBox[{"Part", "[", 
              RowBox[{"#", ",", "2"}], "]"}], ",", 
             RowBox[{"Part", "[", 
              RowBox[{"#", ",", "3"}], "]"}]}], "]"}], "&"}], ",", "coords", 
          ",", "rofun2"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"AppDispVec1", " ", "=", 
      RowBox[{"ElementMeshInterpolation", "[", 
       RowBox[{
        RowBox[{"{", "mesh", "}"}], ",", 
        RowBox[{"valAppDispVec", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppDispVec2", " ", "=", 
      RowBox[{"ElementMeshInterpolation", "[", 
       RowBox[{
        RowBox[{"{", "mesh", "}"}], ",", 
        RowBox[{"valAppDispVec", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppDispVec3", " ", "=", 
      RowBox[{"ElementMeshInterpolation", "[", 
       RowBox[{
        RowBox[{"{", "mesh", "}"}], ",", 
        RowBox[{"valAppDispVec", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "2"}]}], "]"}]}], ";", "\n", 
     "     ", 
     RowBox[{"\[CapitalGamma]g1", "=", 
      RowBox[{"DirichletCondition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"U1", "[", 
          RowBox[{"X1", ",", "X2", ",", "X3"}], "]"}], "\[Equal]", 
         RowBox[{"AppDispVec1", "[", 
          RowBox[{"X1", ",", "X2", ",", "X3"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"X1", "-", " ", "Xorg1"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"X2", "-", " ", "Xorg2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"X3", "-", " ", "Xorg3"}], ")"}], "2"], "-", 
           SuperscriptBox["r", "2"]}], "]"}], "\[LessEqual]", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalGamma]g2", "=", 
      RowBox[{"DirichletCondition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"U2", "[", 
          RowBox[{"X1", ",", "X2", ",", "X3"}], "]"}], "\[Equal]", 
         RowBox[{"AppDispVec2", "[", 
          RowBox[{"X1", ",", "X2", ",", "X3"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"X1", "-", " ", "Xorg1"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"X2", "-", " ", "Xorg2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"X3", "-", " ", "Xorg3"}], ")"}], "2"], "-", 
           SuperscriptBox["r", "2"]}], "]"}], "\[LessEqual]", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalGamma]g3", "=", 
      RowBox[{"DirichletCondition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"U3", "[", 
          RowBox[{"X1", ",", "X2", ",", "X3"}], "]"}], "\[Equal]", 
         RowBox[{"AppDispVec3", "[", 
          RowBox[{"X1", ",", "X2", ",", "X3"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"X1", "-", " ", "Xorg1"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"X2", "-", " ", "Xorg2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"X3", "-", " ", "Xorg3"}], ")"}], "2"], "-", 
           SuperscriptBox["r", "2"]}], "]"}], "\[LessEqual]", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]]}]}], "]"}]}], ";", "\n", "    ", 
     RowBox[{"initBCs", "=", 
      RowBox[{"InitializeBoundaryConditions", "[", 
       RowBox[{"vd", ",", "sd", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "\[CapitalGamma]g1", "}"}], ",", 
          RowBox[{"{", "\[CapitalGamma]g2", "}"}], ",", 
          RowBox[{"{", "\[CapitalGamma]g3", "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"discreteBCs", "=", 
      RowBox[{"DiscretizeBoundaryConditions", "[", 
       RowBox[{"initBCs", ",", "methodData", ",", "sd"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"discretePDE", "=", 
      RowBox[{"DiscretizePDE", "[", 
       RowBox[{"pdeCoefficients", ",", "methodData", ",", "sd"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"load", ",", "stiffness", ",", "damping", ",", "mass"}], "}"}],
       "=", 
      RowBox[{"discretePDE", "[", "\"\<SystemMatrices\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DeployBoundaryConditions", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"load", ",", "stiffness"}], "}"}], ",", "discreteBCs"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"solution", "=", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{"stiffness", ",", "load"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"split", "=", 
      RowBox[{"Span", "@@@", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Most", "[", 
             RowBox[{"#", "+", "1"}], "]"}], ",", 
            RowBox[{"Rest", "[", "#", "]"}]}], "}"}], "&"}], "[", 
         RowBox[{"methodData", "[", "\"\<IncidentOffsets\>\"", "]"}], "]"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Un1", "=", 
      RowBox[{"ElementMeshInterpolation", "[", 
       RowBox[{
        RowBox[{"{", "mesh", "}"}], ",", " ", 
        RowBox[{"solution", "[", 
         RowBox[{"[", 
          RowBox[{"split", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Un2", "=", 
      RowBox[{"ElementMeshInterpolation", "[", 
       RowBox[{
        RowBox[{"{", "mesh", "}"}], ",", " ", 
        RowBox[{"solution", "[", 
         RowBox[{"[", 
          RowBox[{"split", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Un3", "=", 
      RowBox[{"ElementMeshInterpolation", "[", 
       RowBox[{
        RowBox[{"{", "mesh", "}"}], ",", " ", 
        RowBox[{"solution", "[", 
         RowBox[{"[", 
          RowBox[{"split", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dmesh", "=", 
      RowBox[{"ElementMeshDeformation", "[", 
       RowBox[{"mesh", ",", 
        RowBox[{"{", 
         RowBox[{"Un1", ",", "Un2", ",", "Un3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PltMesh", "=", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mesh", "[", "\"\<Wireframe\>\"", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"dmesh", "[", 
           RowBox[{"\"\<Wireframe\>\"", "[", 
            RowBox[{"\"\<ElementMeshDirective\>\"", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"EdgeForm", "[", "Red", "]"}], ",", 
               RowBox[{"FaceForm", "[", "]"}]}], "]"}]}], "]"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"BoxRatios", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
        RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<FEM mesh\>\""}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", "20"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"5.0", ",", " ", "2.4", ",", " ", "2."}], "}"}]}], ",", 
        RowBox[{"ViewAngle", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
        RowBox[{"SphericalRegion", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]1", " ", "=", " ", 
      RowBox[{"ArcTan", "[", 
       RowBox[{"X3", ",", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["X1", "2"], "+", 
           SuperscriptBox["X2", "2"]}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Phi]1", " ", "=", " ", 
      RowBox[{"ArcTan", "[", 
       RowBox[{"X1", ",", "X2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"AMat", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", "\[Theta]1", "]"}], 
             RowBox[{"Cos", "[", "\[Phi]1", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Theta]1", "]"}], 
             RowBox[{"Sin", "[", "\[Phi]1", "]"}]}], ",", 
            RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]1", "]"}], 
             RowBox[{"Cos", "[", "\[Phi]1", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]1", "]"}], 
             RowBox[{"Sin", "[", "\[Phi]1", "]"}]}], ",", 
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Phi]1", "]"}]}], ",", 
            RowBox[{"Cos", "[", "\[Phi]1", "]"}], ",", "0"}], "}"}]}], 
         "}"}]}], ";"}], " ", "*)"}], 
     RowBox[{"(*", 
      RowBox[{
      "Matrix", " ", "converts", " ", "from", " ", "cartesian", " ", "to", 
       " ", "spherical"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"SphericalDisp", "[", 
         RowBox[{
          RowBox[{"X1", ":", "_"}], ",", 
          RowBox[{"X2", ":", "_"}], ",", 
          RowBox[{"X3", ":", "_"}]}], "]"}], " ", "=", " ", 
        RowBox[{"AMat", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Un1", "[", 
             RowBox[{"X1", ",", "X2", ",", "X3"}], "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Un2", "[", 
             RowBox[{"X1", ",", "X2", ",", "X3"}], "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Un3", "[", 
             RowBox[{"X1", ",", "X2", ",", "X3"}], "]"}], "}"}]}], "}"}]}]}], 
       " ", ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Sigma]11", ",", "\[Sigma]22", ",", "\[Sigma]33", ",", "\[Sigma]12", 
        ",", "\[Sigma]23", ",", "\[Sigma]31", ",", "\[Sigma]VM"}], "}"}], "=", 
      RowBox[{"stress3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Un1", ",", "Un2", ",", "Un3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Y", ",", " ", "\[Nu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SigmaIdShell", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Sigma]11", ",", "\[Sigma]12", ",", "\[Sigma]31"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]12", ",", "\[Sigma]22", ",", "\[Sigma]23"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]31", ",", "\[Sigma]23", ",", "\[Sigma]33"}], 
         "}"}]}], "}"}]}], ";", "\n", "     ", 
     RowBox[{"uIdShell", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Un1", ",", "Un2", ",", "Un3"}], "}"}]}], ";", "\n", "     ", 
     RowBox[{
      RowBox[{"rofun2IdShell", "[", 
       RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], " ", "=", " ", 
      RowBox[{"rofun3", "[", 
       RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CloudExport", "[", 
      RowBox[{"SigmaIdShell", ",", "\"\<MX\>\"", ",", 
       RowBox[{
       "\"\<https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/Result/\
Bead1_\>\"", "<>", "\"\<SigmaId_\>\"", "<>", 
        RowBox[{"StringTake", "[", 
         RowBox[{"Str", ",", 
          RowBox[{"4", ";;"}]}], "]"}], "<>", "\"\<.mx\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CloudExport", "[", 
      RowBox[{"uIdShell", ",", "\"\<MX\>\"", ",", 
       RowBox[{
       "\"\<https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/Result/\
Bead1_\>\"", "<>", "\"\<uId_\>\"", "<>", 
        RowBox[{"StringTake", "[", 
         RowBox[{"Str", ",", 
          RowBox[{"4", ";;"}]}], "]"}], "<>", "\"\<.mx\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CloudExport", "[", 
      RowBox[{"rofun2IdShell", ",", "\"\<MX\>\"", ",", 
       RowBox[{
       "\"\<https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/Result/\
Bead1_\>\"", "<>", "\"\<rofun2Id_\>\"", "<>", 
        RowBox[{"StringTake", "[", 
         RowBox[{"Str", ",", 
          RowBox[{"4", ";;"}]}], "]"}], "<>", "\"\<.mx\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s11Shell", "  ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"\[Sigma]11", ",", "#"}], "]"}], "&"}], "/@", "coords"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"s22Shell", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"\[Sigma]22", ",", "#"}], "]"}], "&"}], "/@", "coords"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"s33Shell", "  ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"\[Sigma]33", ",", "#"}], "]"}], "&"}], "/@", "coords"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"prIdShellAvg", " ", "=", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "/", "3"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"s11Shell", " ", "+", "s22Shell", " ", "+", "s33Shell"}], 
          " ", ")"}]}], "]"}], "*", 
       SuperscriptBox["10", "6"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Sigma]IdShell", "[", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"SigmaIdShell", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"SigmaIdShell", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"SigmaIdShell", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "3"}], "]"}], "]"}], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}], ",", 
          "         ", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"SigmaIdShell", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"SigmaIdShell", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"SigmaIdShell", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "3"}], "]"}], "]"}], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"SigmaIdShell", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "1"}], "]"}], "]"}], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"SigmaIdShell", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "2"}], "]"}], "]"}], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"SigmaIdShell", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}]}], "}"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Sigma]IdShell", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Through", "[", 
         RowBox[{"#", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}], "]"}], "&"}], "/@", 
       "SigmaIdShell"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"traction", "[", 
       RowBox[{"X1_", ",", "X2_", ",", "X3_"}], "]"}], ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n1", ",", "n2", ",", "n3", ",", "n", ",", "tn"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n1", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"X1", "-", " ", "Xorg1"}], ")"}], "/", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"X1", "-", " ", "Xorg1"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"X2", "-", " ", "Xorg2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"X3", "-", " ", "Xorg3"}], ")"}], "2"]}]]}], ")"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"n2", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"X2", "-", " ", "Xorg2"}], ")"}], "/", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"X1", "-", " ", "Xorg1"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"X2", "-", " ", "Xorg2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"X3", "-", " ", "Xorg3"}], ")"}], "2"]}]]}], ")"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"n3", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"X3", "-", " ", "Xorg3"}], ")"}], "/", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"X1", "-", " ", "Xorg1"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"X2", "-", " ", "Xorg2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"X3", "-", " ", "Xorg3"}], ")"}], "2"]}]]}], ")"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["n", "1"], ",", 
            SubscriptBox["n", "2"], ",", 
            SubscriptBox["n", "3"]}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tn", " ", "=", 
          RowBox[{
           RowBox[{"\[Sigma]IdShell", "[", 
            RowBox[{"X1", ",", "X2", ",", "X3"}], "]"}], ".", "n"}]}], ";", 
         "\[IndentingNewLine]", "tn"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cell2Surface", "=", 
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rofun3", "[", 
          RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Phi]", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Blue", ",", 
           RowBox[{"Opacity", "[", "0.2", "]"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PltTraction", " ", "=", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"SliceVectorPlot3D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"traction", "[", 
            RowBox[{"X1", ",", "X2", ",", "X3"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<CenterSphere\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"X1", ",", 
            RowBox[{
             RowBox[{"-", "0.75"}], "r"}], ",", 
            RowBox[{"0.75", "r"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"X2", ",", 
            RowBox[{
             RowBox[{"-", "0.75"}], "r"}], ",", 
            RowBox[{"0.75", "r"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"X3", ",", 
            RowBox[{
             RowBox[{"-", "0.75"}], "r"}], ",", 
            RowBox[{"0.75", "r"}]}], "}"}], ",", 
          RowBox[{"VectorStyle", "\[Rule]", "\"\<Arrow3D\>\""}], ",", 
          RowBox[{"VectorColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
         "]"}], ",", "cell2Surface", ",", 
        RowBox[{"BoxRatios", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(t\), \(r\)]\) traction\>\""}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", "20"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"5.0", ",", " ", "2.4", ",", " ", "2."}], "}"}]}], ",", 
        RowBox[{"ViewAngle", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
        RowBox[{"SphericalRegion", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", " ", "=", " ", 
      RowBox[{"Y", "/", 
       RowBox[{"(", 
        RowBox[{"3", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "\[Nu]"}]}], ")"}]}], ")"}]}]}], ";", " ", 
     RowBox[{"\[Mu]1", " ", "=", " ", 
      RowBox[{"Y", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Nu]"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"strain11IdShell", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "Y"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Sigma]IdShell", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", " ", 
         RowBox[{"\[Nu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Sigma]IdShell", "[", 
              RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"\[Sigma]IdShell", "[", 
              RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"strain22IdShell", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "Y"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Sigma]IdShell", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
         RowBox[{"\[Nu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Sigma]IdShell", "[", 
              RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"\[Sigma]IdShell", "[", 
              RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"strain33IdShell", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "Y"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Sigma]IdShell", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "-", " ", 
         RowBox[{"\[Nu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Sigma]IdShell", "[", 
              RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"\[Sigma]IdShell", "[", 
              RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"strain12IdShell", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Sigma]IdShell", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", "\[Mu]1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"strain23IdShell", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Sigma]IdShell", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", "\[Mu]1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"strain13IdShell", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Sigma]IdShell", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", "\[Mu]1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"strainIdShell", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strain11IdShell", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"strain12IdShell", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"strain13IdShell", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strain12IdShell", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"strain22IdShell", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"strain23IdShell", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strain13IdShell", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"strain23IdShell", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"strain33IdShell", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"workDensityIdShell", "  ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"\[Sigma]IdShell", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"#", ",", "1"}], "]"}], ",", 
             RowBox[{"Part", "[", 
              RowBox[{"#", ",", "2"}], "]"}], ",", 
             RowBox[{"Part", "[", 
              RowBox[{"#", ",", "3"}], "]"}]}], "]"}], ".", 
           RowBox[{"Transpose", "[", 
            RowBox[{"strainIdShell", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "1"}], "]"}], ",", 
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "2"}], "]"}], ",", 
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "3"}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
        "&"}], "/@", "coords"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"WorkDoneIdShell", "=", " ", 
      RowBox[{
       RowBox[{"Total", "[", "workDensityIdShell", "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"4", "/", "3"}], ")"}], "*", "\[Pi]", "*", 
       SuperscriptBox["r1", "3"], "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "PltMesh", ",", "PltTraction", ",", "prIdShellAvg", ",", 
       "WorkDoneIdShell"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{
  3.7772212306283407`*^9, {3.7772212790657387`*^9, 3.777221285037827*^9}, {
   3.777221360148245*^9, 3.7772213934349422`*^9}, {3.777225555671623*^9, 
   3.777225559287475*^9}, {3.777317809255889*^9, 3.777317835010441*^9}, 
   3.777320148393285*^9, {3.777320259573661*^9, 3.7773202791545877`*^9}, 
   3.777320488794653*^9, 3.777320540856626*^9, {3.777320762203196*^9, 
   3.777320762449278*^9}, {3.777321425947147*^9, 3.7773214263228703`*^9}, {
   3.777321527048522*^9, 3.7773215274849377`*^9}, {3.777322202348584*^9, 
   3.7773223477027407`*^9}, {3.7773224219411783`*^9, 3.777322438228956*^9}, {
   3.7773369949513407`*^9, 3.777337000406446*^9}, {3.777337072765141*^9, 
   3.777337073190995*^9}, {3.777337113191451*^9, 3.777337122060977*^9}, 
   3.777337207958536*^9, {3.777337442068536*^9, 3.777337442291888*^9}, {
   3.777337791920691*^9, 3.777337967938633*^9}, {3.777338139204522*^9, 
   3.777338140979785*^9}, {3.77733818575247*^9, 3.777338215722994*^9}, 
   3.777338267431973*^9, {3.7773382996323633`*^9, 3.777338301371594*^9}, 
   3.7773383847228823`*^9, {3.777338534300194*^9, 3.777338554079824*^9}, {
   3.7773386136834373`*^9, 3.777338668252743*^9}, {3.777338698832347*^9, 
   3.7773387301630077`*^9}, 3.7773391840573072`*^9, {3.777340500959303*^9, 
   3.777340501352324*^9}, {3.777392838194415*^9, 3.777392861592722*^9}, 
   3.777393134097868*^9, {3.7773938642642593`*^9, 3.777393980332521*^9}, {
   3.7773941976497507`*^9, 3.777394285770647*^9}, {3.777394429610649*^9, 
   3.7773944596022987`*^9}, {3.7773945407962103`*^9, 3.777394588621521*^9}, {
   3.777394629843585*^9, 3.777394652269554*^9}, {3.777394730580946*^9, 
   3.777394747450568*^9}, {3.777548414469667*^9, 3.777548435605739*^9}, {
   3.7775493113419743`*^9, 3.777549394550061*^9}, {3.777551335000332*^9, 
   3.7775513353049192`*^9}, {3.777551485109552*^9, 3.777551641824087*^9}, {
   3.777551834173416*^9, 3.777551946961875*^9}, {3.7775523395804462`*^9, 
   3.777552378591578*^9}, {3.777552461858448*^9, 3.7775524693442183`*^9}, {
   3.777552632476389*^9, 3.777552660036215*^9}, {3.77755272328725*^9, 
   3.7775527285725393`*^9}, {3.777552865334165*^9, 3.777552868468356*^9}, {
   3.777553163131392*^9, 3.777553174985381*^9}, {3.777553412625783*^9, 
   3.777553428418746*^9}, {3.777553529342779*^9, 3.777553530602124*^9}, 
   3.779150670872099*^9, 3.779150706456952*^9, 3.779150756037738*^9, 
   3.77915079118369*^9, 3.779150845249083*^9, {3.7791510699913683`*^9, 
   3.779151088424618*^9}, 3.779151189375684*^9, {3.7791514194306517`*^9, 
   3.779151427594495*^9}, {3.77915150301897*^9, 3.7791515034281397`*^9}, 
   3.779151620493495*^9, {3.779151661653887*^9, 3.779151703692068*^9}, {
   3.779152452964357*^9, 3.779152473268168*^9}, {3.779152510068049*^9, 
   3.779152510272688*^9}, {3.779152830187499*^9, 3.779152830422832*^9}, {
   3.779153056130405*^9, 3.779153070289793*^9}},
 CellLabel->
  "(L2) In[188]:=",ExpressionUUID->"2cb0b255-1f61-42f8-a187-c6116a36faa0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Form Function ", "Subsection",
 CellChangeTimes->{{3.77740555107347*^9, 
  3.777405554536888*^9}},ExpressionUUID->"ca84d23b-105a-4bdc-b780-\
2be0432aee5a"],

Cell[BoxData[
 RowBox[{"ImgProcess", "=", 
  RowBox[{"FormFunction", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<Path\>\"", "\[Rule]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Interpreter\>\"", "\[Rule]", "\"\<String\>\""}], ",", 
         RowBox[{
         "\"\<Input\>\"", "\[Rule]", 
          "\"\<https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/Bead1\>\
\""}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<ZStack\>\"", "\[Rule]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Interpreter\>\"", "\[Rule]", "\"\<Number\>\""}], ",", 
         RowBox[{"\"\<Input\>\"", "\[Rule]", "\"\<1.8\>\""}]}], "|>"}]}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fd", ",", "imgs", ",", "imgs1", ",", "StrList", " ", ",", "fd1", ",",
          "PC1", ",", "r1", ",", "Vol1", ",", "Vol2", ",", "fd2", ",", "PC2", 
         ",", "rofun2", ",", "DeformedShape2", ",", "cell1Surface", ",", 
         "cell2Surface", ",", "cell1Points", ",", "cell2Points", ",", "Plt1", 
         ",", "Plt2", ",", "prIdShellAvg", ",", "WorkDoneIdShell", ",", 
         "PltMesh", ",", "PltTraction"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Needs", "[", "\"\<NDSolve`FEM`\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xOnePixelIsSoManyMicrons", "=", " ", "0.65"}], 
        RowBox[{"(*", "6.48", "*)"}], ";", "\[IndentingNewLine]", 
        RowBox[{"yOnePixelIsSoManyMicrons", "=", "0.65"}], 
        RowBox[{"(*", "6.48", "*)"}], ";", "\[IndentingNewLine]", 
        RowBox[{"zOnePixelIsSoManyMicrons", "=", "#ZStack"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"StrList", " ", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\</1_Outside\>\"", ",", "\"\</2_Shell\>\"", ",", 
           "\"\</3_Between Core and Shell\>\"", ",", "\"\</4_Core\>\"", ",", 
           "\"\</1_Before\>\"", ",", "\"\</2_After\>\""}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fd", " ", "=", " ", "#Path"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Reference", " ", "Shape"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fd1", " ", "=", " ", 
         RowBox[{"fd", "<>", 
          RowBox[{"StrList", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"PC1", " ", "=", " ", 
         RowBox[{"GetPointCloud", "[", 
          RowBox[{
          "xOnePixelIsSoManyMicrons", ",", "yOnePixelIsSoManyMicrons", ",", 
           "zOnePixelIsSoManyMicrons", ",", "fd1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"r1", " ", "=", 
         RowBox[{"FitSphere", "[", "PC1", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cell1Surface", "=", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
            RowBox[{"Sphere", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "r1"}], "]"}]}],
            "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cell1Points", " ", "=", 
         RowBox[{"ListPointPlot3D", "[", 
          RowBox[{
           RowBox[{"{", "PC1", "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", 
              RowBox[{"Opacity", "[", "1.0", "]"}]}], "}"}]}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Plt1", "=", 
         RowBox[{"PlotFitting", "[", 
          RowBox[{"cell1Surface", ",", "cell1Points", ",", 
           RowBox[{"StrList", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Vol1", "=", 
         RowBox[{
          RowBox[{
           FractionBox["4", "3"], "\[Pi]", " ", 
           SuperscriptBox["r1", "3"]}], "//", "N"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Deformed", " ", "Shape"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fd2", " ", "=", " ", 
         RowBox[{"fd", "<>", 
          RowBox[{"StrList", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"PC2", " ", "=", " ", 
         RowBox[{"GetPointCloud", "[", 
          RowBox[{
          "xOnePixelIsSoManyMicrons", ",", "yOnePixelIsSoManyMicrons", ",", 
           "zOnePixelIsSoManyMicrons", ",", "fd2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rofun2", " ", "=", 
         RowBox[{"FitDeformed", "[", "PC2", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Vol2", " ", "=", " ", 
         RowBox[{"ComputeVol2", "@", "rofun2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DeformedShape2", "[", 
          RowBox[{"\[Theta]1_", ",", "\[Phi]1_"}], "]"}], "=", 
         RowBox[{"rofun2", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]", "\[Rule]", "\[Theta]1"}], ",", 
            RowBox[{"\[Phi]", "\[Rule]", "\[Phi]1"}]}], "}"}]}]}], ";", "\t", 
        "\[IndentingNewLine]", 
        RowBox[{"cell2Surface", "=", 
         RowBox[{"ParametricPlot3D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DeformedShape2", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]", "]"}], 
               RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]", "]"}], 
               RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]", ",", "0", ",", 
             RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Opacity", "[", "0.2", "]"}]}], "}"}]}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"cell2Points", "=", 
         RowBox[{"ListPointPlot3D", "[", 
          RowBox[{
           RowBox[{"{", "PC2", "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", 
              RowBox[{"Opacity", "[", "1.0", "]"}]}], "}"}]}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Plt2", "=", 
         RowBox[{"PlotFitting", "[", 
          RowBox[{"cell2Surface", ",", "cell2Points", ",", 
           RowBox[{"StrList", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "FEM", "*)"}], "\[IndentingNewLine]", "InitializeFEM", 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "PltMesh", ",", "PltTraction", ",", "prIdShellAvg", ",", 
           "WorkDoneIdShell"}], "}"}], "=", 
         RowBox[{"FEMResult", "[", 
          RowBox[{
           RowBox[{"StrList", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "r1", ",", "rofun2"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Plt1", ",", "Plt2", ",", "PltMesh", ",", "PltTraction"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "Vol1", ",", "Vol2", ",", "prIdShellAvg", ",", "WorkDoneIdShell"}],
            "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
    "\"\<CloudCDF\>\""}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7771459580277643`*^9, 3.7771459990701118`*^9}, {
   3.7771461494407125`*^9, 3.777146196903427*^9}, {3.777149355993117*^9, 
   3.777149384752762*^9}, {3.7771494794491777`*^9, 3.777149521480582*^9}, {
   3.77714955483349*^9, 3.7771496535291348`*^9}, {3.77714971131744*^9, 
   3.777149752295784*^9}, {3.7771499918734875`*^9, 3.777149993376573*^9}, {
   3.777205698174177*^9, 3.777205706867826*^9}, {3.777205889772437*^9, 
   3.777205965495718*^9}, {3.77720607968639*^9, 3.777206101173668*^9}, {
   3.777219872813518*^9, 3.777219955137618*^9}, {3.7772199897217903`*^9, 
   3.7772200858143263`*^9}, {3.777220231485009*^9, 3.7772202890953083`*^9}, {
   3.7772203199449673`*^9, 3.777220322375757*^9}, {3.777220810185753*^9, 
   3.7772209400926323`*^9}, {3.7772209985246964`*^9, 
   3.7772210005943813`*^9}, {3.777221071234797*^9, 3.777221084058*^9}, {
   3.777221435959518*^9, 3.777221448850753*^9}, {3.777221534149006*^9, 
   3.777221537154811*^9}, {3.777221575572521*^9, 3.777221617209064*^9}, {
   3.777221684158038*^9, 3.7772217112472754`*^9}, {3.77722174564023*^9, 
   3.777221846823451*^9}, 3.7772221365621443`*^9, {3.7772222938218822`*^9, 
   3.777222388075747*^9}, 3.777222438948358*^9, {3.777222612695525*^9, 
   3.777222619350952*^9}, {3.7772226781708727`*^9, 3.7772227132916737`*^9}, 
   3.777222747971377*^9, {3.777222778963457*^9, 3.777222797983406*^9}, 
   3.7772228574024343`*^9, 3.7772229471504087`*^9, 3.7772230680827007`*^9, {
   3.7772231253636827`*^9, 3.7772231322891617`*^9}, {3.777223219625741*^9, 
   3.777223222120758*^9}, {3.777223274785578*^9, 3.7772234035027943`*^9}, {
   3.7772234573813457`*^9, 3.777223458551155*^9}, {3.777223534595272*^9, 
   3.777223538651987*^9}, {3.7772236011185207`*^9, 3.7772236202839527`*^9}, {
   3.777223693443725*^9, 3.777223694756247*^9}, 3.7772238332362223`*^9, {
   3.7772239122868032`*^9, 3.777223952266725*^9}, {3.7772239869257727`*^9, 
   3.777224016141753*^9}, {3.7772242001610537`*^9, 3.777224200811963*^9}, {
   3.7772245443962097`*^9, 3.7772245908412237`*^9}, {3.7772246685458183`*^9, 
   3.777224698129245*^9}, {3.7772247549663467`*^9, 3.7772247571240807`*^9}, {
   3.777225381642626*^9, 3.777225459030829*^9}, {3.777225618818841*^9, 
   3.7772256246363783`*^9}, {3.7772258772301826`*^9, 3.777225881560822*^9}, {
   3.777226018195812*^9, 3.777226111467462*^9}, {3.777226166381466*^9, 
   3.7772261699340897`*^9}, {3.77722624607652*^9, 3.777226251812152*^9}, {
   3.7772263171231194`*^9, 3.777226359959425*^9}, {3.777291682760846*^9, 
   3.77729172611516*^9}, {3.7772918261819887`*^9, 3.777291870765669*^9}, 
   3.7773164075282593`*^9, {3.777316504498971*^9, 3.7773165320962353`*^9}, 
   3.777316774908762*^9, {3.77731701379139*^9, 3.777317160738113*^9}, {
   3.7773174061146183`*^9, 3.777317443811716*^9}, {3.777317591212369*^9, 
   3.777317632433223*^9}, {3.777317687873348*^9, 3.777317704048418*^9}, 
   3.777317960834984*^9, {3.7773181376389303`*^9, 3.777318176983243*^9}, {
   3.7773182865320663`*^9, 3.7773183230645447`*^9}, 3.777318357816452*^9, 
   3.777318453532632*^9, {3.777318506709124*^9, 3.777318510297319*^9}, 
   3.777318594766912*^9, {3.7773186874866447`*^9, 3.777318693998413*^9}, {
   3.7773188130016823`*^9, 3.7773189378212337`*^9}, {3.7773189721773663`*^9, 
   3.777318973774613*^9}, {3.777319037351367*^9, 3.777319081233515*^9}, {
   3.777319127959545*^9, 3.777319148986429*^9}, {3.777319318504589*^9, 
   3.777319339190835*^9}, {3.777319404726685*^9, 3.777319427451542*^9}, {
   3.7773194874588842`*^9, 3.777319816809052*^9}, {3.777319917286709*^9, 
   3.7773200754972067`*^9}, {3.777320348719393*^9, 3.777320349996636*^9}, {
   3.7773203918300877`*^9, 3.77732041277306*^9}, {3.7773208246758957`*^9, 
   3.777320834229919*^9}, {3.777320963196642*^9, 3.77732098383638*^9}, {
   3.777321029810239*^9, 3.7773210327283907`*^9}, {3.777321104657648*^9, 
   3.77732110886061*^9}, {3.7773211749974203`*^9, 3.7773211837388287`*^9}, {
   3.7773212329720163`*^9, 3.777321389684883*^9}, {3.777322299556601*^9, 
   3.777322307554945*^9}, {3.7773233438780737`*^9, 3.7773233991404037`*^9}, {
   3.777337082310731*^9, 3.7773371002020197`*^9}, 3.777338946368917*^9, {
   3.777340056065783*^9, 3.777340110293565*^9}, {3.777392401398788*^9, 
   3.777392418916484*^9}, {3.777392570315929*^9, 3.7773925881991873`*^9}, {
   3.777392644808392*^9, 3.777392668277309*^9}, {3.777393225171774*^9, 
   3.777393242555725*^9}, {3.777393314748155*^9, 3.777393356944886*^9}, {
   3.77739352288428*^9, 3.777393528676849*^9}, {3.777393778646022*^9, 
   3.777393785615185*^9}, {3.777394006343973*^9, 3.777394018282687*^9}, 
   3.777548349697158*^9, {3.777548381430035*^9, 3.777548390361044*^9}, {
   3.77755198588638*^9, 3.7775520514706078`*^9}, 3.779151159298974*^9},
 CellLabel->
  "In[128]:=",ExpressionUUID->"3ea47407-8239-4d63-9d7c-64eab4b44e52"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CloudDeploy", "[", 
  RowBox[{"ImgProcess", ",", 
   RowBox[{
   "CloudObject", "[", 
    "\"\<https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/FullVersion\>\
\"", "]"}], ",", 
   RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.777146009985736*^9, 3.7771460231264877`*^9}, {
   3.7771460726943226`*^9, 3.777146102144007*^9}, 3.777206092680257*^9, 
   3.777220870195608*^9, {3.7773168424295607`*^9, 3.7773168444840927`*^9}, {
   3.7775520657914743`*^9, 3.7775520682084017`*^9}, {3.7775521030960712`*^9, 
   3.7775521038802757`*^9}, {3.779152870703608*^9, 3.779152878643487*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"cec1e147-d6a2-4638-97e7-d084c55607eb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"CloudObject", "[", 
   TemplateBox[{
    "\"https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/FullVersion\"",
     "https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/FullVersion"},
    "HyperlinkURL"], "]"}],
  CloudObject[
  "https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/FullVersion"],
  SelectWithContents->True]], "Output",
 CellChangeTimes->{{3.7771460843769913`*^9, 3.7771461042061253`*^9}, {
   3.77714615499403*^9, 3.777146179201415*^9}, 3.777149388855996*^9, {
   3.7771495833161187`*^9, 3.7771496009101253`*^9}, 3.777149631036848*^9, {
   3.7771497266173153`*^9, 3.777149755315957*^9}, 3.777149996798769*^9, 
   3.777205337564374*^9, 3.777220871816538*^9, 3.777220913531806*^9, 
   3.777222395009777*^9, 3.7772224859486847`*^9, 3.7772226494483347`*^9, 
   3.777222686974146*^9, 3.7772227224742413`*^9, 3.77722275899646*^9, 
   3.777222860773231*^9, 3.7772230885227823`*^9, 3.777223137331292*^9, 
   3.777223228617518*^9, 3.777224039034749*^9, 3.777224236284505*^9, 
   3.777224724453218*^9, 3.777224764006757*^9, 3.777225590790791*^9, 
   3.7772256547172422`*^9, 3.777225888140937*^9, 3.7772259207467546`*^9, 
   3.777226122850856*^9, 3.777316850249543*^9, 3.777317456121739*^9, 
   3.777320113264688*^9, 3.777320158357236*^9, 3.777320310146789*^9, {
   3.777320422553932*^9, 3.777320430019795*^9}, 3.777320843286079*^9, 
   3.777320990759961*^9, 3.7773210413372803`*^9, 3.777321194449616*^9, 
   3.7773234063604*^9, 3.777323654731173*^9, 3.777338753518702*^9, 
   3.777339205251172*^9, 3.777340145093019*^9, 3.777340547651841*^9, 
   3.777392426658835*^9, 3.7773924650760202`*^9, 3.777393063404933*^9, 
   3.777393249324958*^9, 3.777393469854712*^9, 3.7773935373233337`*^9, 
   3.777394022045496*^9, 3.777394077659387*^9, 3.777394135429819*^9, 
   3.777485582083103*^9, 3.777552109554963*^9, 3.777552170740963*^9, 
   3.777552609443015*^9, 3.777552700121819*^9, {3.777552739327177*^9, 
   3.777552755090363*^9}, 3.777552879494589*^9, 3.777553558184512*^9, 
   3.779150374081586*^9, 3.7791513547273693`*^9, 3.779151723154818*^9, 
   3.779151920690537*^9, 3.779152658706663*^9, 3.779152880556945*^9, 
   3.779153033423402*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"cf48994e-3cf0-49d4-8b6d-e24caa631fa0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["$CloudCreditsAvailable"], "Input",
 CellChangeTimes->{{3.777339459038485*^9, 3.777339463391642*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"6f3c6bd2-badd-4614-95f1-4f09f5233c3d"],

Cell[BoxData["34965"], "Output",
 CellChangeTimes->{
  3.777150909750987*^9, 3.7771515049000273`*^9, {3.77720614070251*^9, 
   3.777206142203114*^9}, 3.777224728948045*^9, 3.7772256966298447`*^9, 
   3.777225968329851*^9, 3.7773208455900297`*^9, 3.7773211966268587`*^9, {
   3.7773394671212273`*^9, 3.7773394706743727`*^9}, 3.777393478167927*^9, 
   3.7774855843949747`*^9, {3.777552191470354*^9, 3.777552198260892*^9}, 
   3.779151358495131*^9, 3.7791530361469584`*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"058a9009-9868-4335-bbfd-1cf5054a1d29"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Form function with table output", "Subsection",
 CellChangeTimes->{{3.782061807807499*^9, 
  3.782061816693811*^9}},ExpressionUUID->"236fa205-d28f-44bf-bc44-\
660716bfa744"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ImgProcess2", "=", 
  RowBox[{"FormFunction", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<Path\>\"", "\[Rule]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Interpreter\>\"", "\[Rule]", "\"\<String\>\""}], ",", 
         RowBox[{
         "\"\<Input\>\"", "\[Rule]", 
          "\"\<https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/Bead1\>\
\""}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<ZStack\>\"", "\[Rule]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Interpreter\>\"", "\[Rule]", "\"\<Number\>\""}], ",", 
         RowBox[{"\"\<Input\>\"", "\[Rule]", "\"\<1.8\>\""}]}], "|>"}]}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fd", ",", "imgs", ",", "imgs1", ",", "StrList", " ", ",", "fd1", ",",
          "PC1", ",", "r1", ",", "Vol1", ",", "Vol2", ",", "fd2", ",", "PC2", 
         ",", "rofun2", ",", "DeformedShape2", ",", "cell1Surface", ",", 
         "cell2Surface", ",", "cell1Points", ",", "cell2Points", ",", "Plt1", 
         ",", "Plt2", ",", "prIdShellAvg", ",", "WorkDoneIdShell", ",", 
         "PltMesh", ",", "PltTraction", ",", "NameList", ",", "NumList", ",", 
         "data", ",", "to"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Needs", "[", "\"\<NDSolve`FEM`\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xOnePixelIsSoManyMicrons", "=", " ", "0.65"}], 
        RowBox[{"(*", "6.48", "*)"}], ";", "\[IndentingNewLine]", 
        RowBox[{"yOnePixelIsSoManyMicrons", "=", "0.65"}], 
        RowBox[{"(*", "6.48", "*)"}], ";", "\[IndentingNewLine]", 
        RowBox[{"zOnePixelIsSoManyMicrons", "=", "#ZStack"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"StrList", " ", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\</1_Outside\>\"", ",", "\"\</2_Shell\>\"", ",", 
           "\"\</3_Between Core and Shell\>\"", ",", "\"\</4_Core\>\"", ",", 
           "\"\</1_Before\>\"", ",", "\"\</2_After\>\""}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fd", " ", "=", " ", "#Path"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Reference", " ", "Shape"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fd1", " ", "=", " ", 
         RowBox[{"fd", "<>", 
          RowBox[{"StrList", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"PC1", " ", "=", " ", 
         RowBox[{"GetPointCloud", "[", 
          RowBox[{
          "xOnePixelIsSoManyMicrons", ",", "yOnePixelIsSoManyMicrons", ",", 
           "zOnePixelIsSoManyMicrons", ",", "fd1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"r1", " ", "=", 
         RowBox[{"FitSphere", "[", "PC1", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cell1Surface", "=", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
            RowBox[{"Sphere", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "r1"}], "]"}]}],
            "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cell1Points", " ", "=", 
         RowBox[{"ListPointPlot3D", "[", 
          RowBox[{
           RowBox[{"{", "PC1", "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", 
              RowBox[{"Opacity", "[", "1.0", "]"}]}], "}"}]}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Plt1", "=", 
         RowBox[{"PlotFitting", "[", 
          RowBox[{"cell1Surface", ",", "cell1Points", ",", 
           RowBox[{"StrList", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Vol1", "=", 
         RowBox[{
          RowBox[{
           FractionBox["4", "3"], "\[Pi]", " ", 
           SuperscriptBox["r1", "3"]}], "//", "N"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Deformed", " ", "Shape"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fd2", " ", "=", " ", 
         RowBox[{"fd", "<>", 
          RowBox[{"StrList", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"PC2", " ", "=", " ", 
         RowBox[{"GetPointCloud", "[", 
          RowBox[{
          "xOnePixelIsSoManyMicrons", ",", "yOnePixelIsSoManyMicrons", ",", 
           "zOnePixelIsSoManyMicrons", ",", "fd2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rofun2", " ", "=", 
         RowBox[{"FitDeformed", "[", "PC2", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Vol2", " ", "=", " ", 
         RowBox[{"ComputeVol2", "@", "rofun2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DeformedShape2", "[", 
          RowBox[{"\[Theta]1_", ",", "\[Phi]1_"}], "]"}], "=", 
         RowBox[{"rofun2", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]", "\[Rule]", "\[Theta]1"}], ",", 
            RowBox[{"\[Phi]", "\[Rule]", "\[Phi]1"}]}], "}"}]}]}], ";", "\t", 
        "\[IndentingNewLine]", 
        RowBox[{"cell2Surface", "=", 
         RowBox[{"ParametricPlot3D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DeformedShape2", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]", "]"}], 
               RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]", "]"}], 
               RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]", ",", "0", ",", 
             RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Opacity", "[", "0.2", "]"}]}], "}"}]}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"cell2Points", "=", 
         RowBox[{"ListPointPlot3D", "[", 
          RowBox[{
           RowBox[{"{", "PC2", "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", 
              RowBox[{"Opacity", "[", "1.0", "]"}]}], "}"}]}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Plt2", "=", 
         RowBox[{"PlotFitting", "[", 
          RowBox[{"cell2Surface", ",", "cell2Points", ",", 
           RowBox[{"StrList", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "FEM", "*)"}], "\[IndentingNewLine]", "InitializeFEM", 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "PltMesh", ",", "PltTraction", ",", "prIdShellAvg", ",", 
           "WorkDoneIdShell"}], "}"}], "=", 
         RowBox[{"FEMResult", "[", 
          RowBox[{
           RowBox[{"StrList", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "r1", ",", "rofun2"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"NameList", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Reference Volume (\!\(\*SuperscriptBox[\(\[Micro]m\), \
\(3\)]\))\>\"", ",", 
           "\"\<Deformed Volume (\!\(\*SuperscriptBox[\(\[Micro]m\), \
\(3\)]\))\>\"", ",", "\"\<Average Pressure (Pa)\>\"", ",", 
           "\"\<Elastic Energy (\[Micro]J)\>\""}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"NumList", "=", 
         RowBox[{"{", 
          RowBox[{
          "Vol1", ",", "Vol2", ",", "prIdShellAvg", ",", "WorkDoneIdShell"}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", " ", "=", " ", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{"NameList", ",", "NumList"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"to", " ", "=", 
         RowBox[{"Grid", "[", 
          RowBox[{"data", ",", 
           RowBox[{"Background", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Lighter", "[", 
                 RowBox[{"Yellow", ",", ".9"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"White", ",", 
                  RowBox[{"Lighter", "[", 
                   RowBox[{
                    RowBox[{"Blend", "[", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Green"}], "}"}], "]"}], ",", ".8"}],
                    "]"}]}], "}"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Dividers", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Darker", "[", 
                 RowBox[{"Gray", ",", ".6"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lighter", "[", 
                  RowBox[{"Gray", ",", ".5"}], "]"}], "}"}], ",", 
                RowBox[{"Darker", "[", 
                 RowBox[{"Gray", ",", ".6"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Darker", "[", 
                 RowBox[{"Gray", ",", ".6"}], "]"}], ",", 
                RowBox[{"Darker", "[", 
                 RowBox[{"Gray", ",", ".6"}], "]"}], ",", 
                RowBox[{"{", "False", "}"}], ",", 
                RowBox[{"Darker", "[", 
                 RowBox[{"Gray", ",", ".6"}], "]"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Alignment", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"Left", ",", "Right", ",", 
               RowBox[{"{", "Left", "}"}]}], "}"}], "}"}]}], ",", 
           RowBox[{"ItemSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"10", ",", "3", ",", "5", ",", "5"}], "}"}], "}"}]}], 
           ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"Gray", ",", ".6"}], "]"}]}], ",", 
           RowBox[{"ItemStyle", "\[Rule]", "14"}], ",", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", ".8"}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "Plt1", ",", "Plt2", ",", "PltMesh", ",", "PltTraction", ",", "to"}],
          "}"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
    "\"\<CloudCDF\>\""}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7771459580277643`*^9, 3.7771459990701118`*^9}, {
   3.7771461494407125`*^9, 3.777146196903427*^9}, {3.777149355993117*^9, 
   3.777149384752762*^9}, {3.7771494794491777`*^9, 3.777149521480582*^9}, {
   3.77714955483349*^9, 3.7771496535291348`*^9}, {3.77714971131744*^9, 
   3.777149752295784*^9}, {3.7771499918734875`*^9, 3.777149993376573*^9}, {
   3.777205698174177*^9, 3.777205706867826*^9}, {3.777205889772437*^9, 
   3.777205965495718*^9}, {3.77720607968639*^9, 3.777206101173668*^9}, {
   3.777219872813518*^9, 3.777219955137618*^9}, {3.7772199897217903`*^9, 
   3.7772200858143263`*^9}, {3.777220231485009*^9, 3.7772202890953083`*^9}, {
   3.7772203199449673`*^9, 3.777220322375757*^9}, {3.777220810185753*^9, 
   3.7772209400926323`*^9}, {3.7772209985246964`*^9, 
   3.7772210005943813`*^9}, {3.777221071234797*^9, 3.777221084058*^9}, {
   3.777221435959518*^9, 3.777221448850753*^9}, {3.777221534149006*^9, 
   3.777221537154811*^9}, {3.777221575572521*^9, 3.777221617209064*^9}, {
   3.777221684158038*^9, 3.7772217112472754`*^9}, {3.77722174564023*^9, 
   3.777221846823451*^9}, 3.7772221365621443`*^9, {3.7772222938218822`*^9, 
   3.777222388075747*^9}, 3.777222438948358*^9, {3.777222612695525*^9, 
   3.777222619350952*^9}, {3.7772226781708727`*^9, 3.7772227132916737`*^9}, 
   3.777222747971377*^9, {3.777222778963457*^9, 3.777222797983406*^9}, 
   3.7772228574024343`*^9, 3.7772229471504087`*^9, 3.7772230680827007`*^9, {
   3.7772231253636827`*^9, 3.7772231322891617`*^9}, {3.777223219625741*^9, 
   3.777223222120758*^9}, {3.777223274785578*^9, 3.7772234035027943`*^9}, {
   3.7772234573813457`*^9, 3.777223458551155*^9}, {3.777223534595272*^9, 
   3.777223538651987*^9}, {3.7772236011185207`*^9, 3.7772236202839527`*^9}, {
   3.777223693443725*^9, 3.777223694756247*^9}, 3.7772238332362223`*^9, {
   3.7772239122868032`*^9, 3.777223952266725*^9}, {3.7772239869257727`*^9, 
   3.777224016141753*^9}, {3.7772242001610537`*^9, 3.777224200811963*^9}, {
   3.7772245443962097`*^9, 3.7772245908412237`*^9}, {3.7772246685458183`*^9, 
   3.777224698129245*^9}, {3.7772247549663467`*^9, 3.7772247571240807`*^9}, {
   3.777225381642626*^9, 3.777225459030829*^9}, {3.777225618818841*^9, 
   3.7772256246363783`*^9}, {3.7772258772301826`*^9, 3.777225881560822*^9}, {
   3.777226018195812*^9, 3.777226111467462*^9}, {3.777226166381466*^9, 
   3.7772261699340897`*^9}, {3.77722624607652*^9, 3.777226251812152*^9}, {
   3.7772263171231194`*^9, 3.777226359959425*^9}, {3.777291682760846*^9, 
   3.77729172611516*^9}, {3.7772918261819887`*^9, 3.777291870765669*^9}, 
   3.7773164075282593`*^9, {3.777316504498971*^9, 3.7773165320962353`*^9}, 
   3.777316774908762*^9, {3.77731701379139*^9, 3.777317160738113*^9}, {
   3.7773174061146183`*^9, 3.777317443811716*^9}, {3.777317591212369*^9, 
   3.777317632433223*^9}, {3.777317687873348*^9, 3.777317704048418*^9}, 
   3.777317960834984*^9, {3.7773181376389303`*^9, 3.777318176983243*^9}, {
   3.7773182865320663`*^9, 3.7773183230645447`*^9}, 3.777318357816452*^9, 
   3.777318453532632*^9, {3.777318506709124*^9, 3.777318510297319*^9}, 
   3.777318594766912*^9, {3.7773186874866447`*^9, 3.777318693998413*^9}, {
   3.7773188130016823`*^9, 3.7773189378212337`*^9}, {3.7773189721773663`*^9, 
   3.777318973774613*^9}, {3.777319037351367*^9, 3.777319081233515*^9}, {
   3.777319127959545*^9, 3.777319148986429*^9}, {3.777319318504589*^9, 
   3.777319339190835*^9}, {3.777319404726685*^9, 3.777319427451542*^9}, {
   3.7773194874588842`*^9, 3.777319816809052*^9}, {3.777319917286709*^9, 
   3.7773200754972067`*^9}, {3.777320348719393*^9, 3.777320349996636*^9}, {
   3.7773203918300877`*^9, 3.77732041277306*^9}, {3.7773208246758957`*^9, 
   3.777320834229919*^9}, {3.777320963196642*^9, 3.77732098383638*^9}, {
   3.777321029810239*^9, 3.7773210327283907`*^9}, {3.777321104657648*^9, 
   3.77732110886061*^9}, {3.7773211749974203`*^9, 3.7773211837388287`*^9}, {
   3.7773212329720163`*^9, 3.777321389684883*^9}, {3.777322299556601*^9, 
   3.777322307554945*^9}, {3.7773233438780737`*^9, 3.7773233991404037`*^9}, {
   3.777337082310731*^9, 3.7773371002020197`*^9}, 3.777338946368917*^9, {
   3.777340056065783*^9, 3.777340110293565*^9}, {3.777392401398788*^9, 
   3.777392418916484*^9}, {3.777392570315929*^9, 3.7773925881991873`*^9}, {
   3.777392644808392*^9, 3.777392668277309*^9}, {3.777393225171774*^9, 
   3.777393242555725*^9}, {3.777393314748155*^9, 3.777393356944886*^9}, {
   3.77739352288428*^9, 3.777393528676849*^9}, {3.777393778646022*^9, 
   3.777393785615185*^9}, {3.777394006343973*^9, 3.777394018282687*^9}, 
   3.777548349697158*^9, {3.777548381430035*^9, 3.777548390361044*^9}, {
   3.77755198588638*^9, 3.7775520514706078`*^9}, 3.779151159298974*^9, {
   3.782061829446247*^9, 3.782061890083906*^9}, {3.7820623737465057`*^9, 
   3.782062384569727*^9}},
 CellLabel->
  "(L2) In[194]:=",ExpressionUUID->"7f59b6ba-5ffd-4fa6-b291-6c815abd2411"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["FormFunction",
    "SummaryHead"], "[", 
   TemplateBox[{DynamicModuleBox[{Forms`Format`PackagePrivate`values$$}, 
      DynamicBox[
       ToBoxes[
        If[
         ValueQ[Forms`Format`PackagePrivate`values$$], 
         Column[{
           Panel[
            Style[
             (
             Module[{$CellContext`fd, $CellContext`imgs, $CellContext`imgs1, \
$CellContext`StrList, $CellContext`fd1, $CellContext`PC1, $CellContext`r1, \
$CellContext`Vol1, $CellContext`Vol2, $CellContext`fd2, $CellContext`PC2, \
$CellContext`rofun2, $CellContext`DeformedShape2, $CellContext`cell1Surface, \
$CellContext`cell2Surface, $CellContext`cell1Points, \
$CellContext`cell2Points, $CellContext`Plt1, $CellContext`Plt2, \
$CellContext`prIdShellAvg, $CellContext`WorkDoneIdShell, \
$CellContext`PltMesh, $CellContext`PltTraction, $CellContext`NameList, \
$CellContext`NumList, $CellContext`data, $CellContext`to}, 
              Needs["NDSolve`FEM`"]; $CellContext`xOnePixelIsSoManyMicrons = 
               0.65; $CellContext`yOnePixelIsSoManyMicrons = 
               0.65; $CellContext`zOnePixelIsSoManyMicrons = 
               Slot["ZStack"]; $CellContext`StrList = {
                "/1_Outside", "/2_Shell", "/3_Between Core and Shell", 
                 "/4_Core", "/1_Before", "/2_After"}; $CellContext`fd = 
               Slot["Path"]; $CellContext`fd1 = StringJoin[$CellContext`fd, 
                 
                 Part[$CellContext`StrList, 
                  1]]; $CellContext`PC1 = \
$CellContext`GetPointCloud[$CellContext`xOnePixelIsSoManyMicrons, \
$CellContext`yOnePixelIsSoManyMicrons, $CellContext`zOnePixelIsSoManyMicrons, \
$CellContext`fd1]; $CellContext`r1 = $CellContext`FitSphere[$CellContext`PC1]; \
$CellContext`cell1Surface = Graphics3D[{
                  Opacity[0.3], 
                  
                  Sphere[{0, 0, 
                   0}, $CellContext`r1]}]; $CellContext`cell1Points = 
               ListPointPlot3D[{$CellContext`PC1}, PlotStyle -> {Black, 
                   Opacity[
                   1.]}]; $CellContext`Plt1 = \
$CellContext`PlotFitting[$CellContext`cell1Surface, $CellContext`cell1Points, 
                 Part[$CellContext`StrList, 1]]; $CellContext`Vol1 = 
               N[(4/3) Pi $CellContext`r1^3]; $CellContext`fd2 = 
               StringJoin[$CellContext`fd, 
                 
                 Part[$CellContext`StrList, 
                  2]]; $CellContext`PC2 = \
$CellContext`GetPointCloud[$CellContext`xOnePixelIsSoManyMicrons, \
$CellContext`yOnePixelIsSoManyMicrons, $CellContext`zOnePixelIsSoManyMicrons, \
$CellContext`fd2]; $CellContext`rofun2 = \
$CellContext`FitDeformed[$CellContext`PC2]; $CellContext`Vol2 = \
$CellContext`ComputeVol2[$CellContext`rofun2]; $CellContext`DeformedShape2[
                 Pattern[$CellContext`\[Theta]1, 
                  Blank[]], 
                 Pattern[$CellContext`\[Phi]1, 
                  Blank[]]] = 
               ReplaceAll[$CellContext`rofun2, {$CellContext`\[Theta] -> \
$CellContext`\[Theta]1, $CellContext`\[Phi] -> $CellContext`\[Phi]1}]; \
$CellContext`cell2Surface = 
               ParametricPlot3D[$CellContext`DeformedShape2[$CellContext`\
\[Theta], $CellContext`\[Phi]] {
                  Sin[$CellContext`\[Theta]] Cos[$CellContext`\[Phi]], 
                   Sin[$CellContext`\[Theta]] Sin[$CellContext`\[Phi]], 
                   Cos[$CellContext`\[Theta]]}, {$CellContext`\[Theta], 0, 
                  Pi}, {$CellContext`\[Phi], 0, 2 Pi}, PlotStyle -> {Blue, 
                   Opacity[0.2]}]; $CellContext`cell2Points = 
               ListPointPlot3D[{$CellContext`PC2}, PlotStyle -> {Black, 
                   Opacity[
                   1.]}]; $CellContext`Plt2 = \
$CellContext`PlotFitting[$CellContext`cell2Surface, $CellContext`cell2Points, 
                 
                 Part[$CellContext`StrList, 
                  2]]; $CellContext`InitializeFEM; {$CellContext`PltMesh, \
$CellContext`PltTraction, $CellContext`prIdShellAvg, \
$CellContext`WorkDoneIdShell} = $CellContext`FEMResult[
                 
                 Part[$CellContext`StrList, 
                  2], $CellContext`r1, $CellContext`rofun2]; \
$CellContext`NameList = {
                "Reference Volume (\!\(\*SuperscriptBox[\(\[Micro]m\), \(3\)]\
\))", "Deformed Volume (\!\(\*SuperscriptBox[\(\[Micro]m\), \(3\)]\))", 
                 "Average Pressure (Pa)", 
                 "Elastic Energy (\[Micro]J)"}; $CellContext`NumList = \
{$CellContext`Vol1, $CellContext`Vol2, $CellContext`prIdShellAvg, \
$CellContext`WorkDoneIdShell}; $CellContext`data = 
               Transpose[{$CellContext`NameList, $CellContext`NumList}]; \
$CellContext`to = Grid[$CellContext`data, Background -> {None, {
                    Lighter[Yellow, 0.9], {White, 
                    Lighter[
                    Blend[{Blue, Green}], 0.8]}}}, Dividers -> {{
                    Darker[Gray, 0.6], {
                    Lighter[Gray, 0.5]}, 
                    Darker[Gray, 0.6]}, {
                    Darker[Gray, 0.6], 
                    Darker[Gray, 0.6], {False}, 
                    Darker[Gray, 0.6]}}, Alignment -> {{Left, Right, {Left}}},
                  ItemSize -> {{10, 3, 5, 5}}, Frame -> Darker[Gray, 0.6], 
                 ItemStyle -> 14, 
                 Spacings -> {
                  Automatic, 
                   0.8}]; {$CellContext`Plt1, $CellContext`Plt2, \
$CellContext`PltMesh, $CellContext`PltTraction, $CellContext`to}]& )[
             Forms`Format`PackagePrivate`values$$], "Output", "StandardForm"],
             Background -> White], 
           Item[
            Row[{
              Spacer[0], 
              Forms`Format`PackagePrivate`formCancelButton["Back", 
               Clear[Forms`Format`PackagePrivate`values$$], 
               FormObject[
                Association[
                "Path" -> Association[
                  "Interpreter" -> "String", "Input" -> 
                   "https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/\
Bead1"], "ZStack" -> 
                 Association["Interpreter" -> "Number", "Input" -> "1.8"]]][
               AppearanceRules, "FormCancelButtonStyle"]]}], Alignment -> 
            Right]}, Alignment -> Right], 
         Forms`Format`PackagePrivate`values$$; Forms`PackageScope`bindForm[
           Forms`PackageScope`changeAppearanceRule[
            FormObject[
             Association[
             "Path" -> Association[
               "Interpreter" -> "String", "Input" -> 
                "https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/\
Bead1"], "ZStack" -> 
              Association["Interpreter" -> "Number", "Input" -> "1.8"]]], 
            "CancelLabel" -> None], Forms`Format`PackagePrivate`values$$]], 
        StandardForm], 
       TrackedSymbols :> {Forms`Format`PackagePrivate`values$$}], 
      DynamicModuleValues :> {}]},
    "FormPanel"], "]"}],
  FormFunction[
   FormObject[
    Association[
    "Path" -> Association[
      "Interpreter" -> "String", "Input" -> 
       "https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/Bead1"], 
     "ZStack" -> Association["Interpreter" -> "Number", "Input" -> "1.8"]]], 
   Module[{$CellContext`fd, $CellContext`imgs, $CellContext`imgs1, \
$CellContext`StrList, $CellContext`fd1, $CellContext`PC1, $CellContext`r1, \
$CellContext`Vol1, $CellContext`Vol2, $CellContext`fd2, $CellContext`PC2, \
$CellContext`rofun2, $CellContext`DeformedShape2, $CellContext`cell1Surface, \
$CellContext`cell2Surface, $CellContext`cell1Points, \
$CellContext`cell2Points, $CellContext`Plt1, $CellContext`Plt2, \
$CellContext`prIdShellAvg, $CellContext`WorkDoneIdShell, \
$CellContext`PltMesh, $CellContext`PltTraction, $CellContext`NameList, \
$CellContext`NumList, $CellContext`data, $CellContext`to}, 
    Needs["NDSolve`FEM`"]; $CellContext`xOnePixelIsSoManyMicrons = 
     0.65; $CellContext`yOnePixelIsSoManyMicrons = 
     0.65; $CellContext`zOnePixelIsSoManyMicrons = 
     Slot["ZStack"]; $CellContext`StrList = {
      "/1_Outside", "/2_Shell", "/3_Between Core and Shell", "/4_Core", 
       "/1_Before", "/2_After"}; $CellContext`fd = 
     Slot["Path"]; $CellContext`fd1 = StringJoin[$CellContext`fd, 
       Part[$CellContext`StrList, 
        1]]; $CellContext`PC1 = \
$CellContext`GetPointCloud[$CellContext`xOnePixelIsSoManyMicrons, \
$CellContext`yOnePixelIsSoManyMicrons, $CellContext`zOnePixelIsSoManyMicrons, \
$CellContext`fd1]; $CellContext`r1 = $CellContext`FitSphere[$CellContext`PC1]; \
$CellContext`cell1Surface = Graphics3D[{
        Opacity[0.3], 
        Sphere[{0, 0, 0}, $CellContext`r1]}]; $CellContext`cell1Points = 
     ListPointPlot3D[{$CellContext`PC1}, PlotStyle -> {Black, 
         Opacity[
         1.]}]; $CellContext`Plt1 = \
$CellContext`PlotFitting[$CellContext`cell1Surface, $CellContext`cell1Points, 
       Part[$CellContext`StrList, 1]]; $CellContext`Vol1 = 
     N[(4/3) Pi $CellContext`r1^3]; $CellContext`fd2 = 
     StringJoin[$CellContext`fd, 
       Part[$CellContext`StrList, 
        2]]; $CellContext`PC2 = \
$CellContext`GetPointCloud[$CellContext`xOnePixelIsSoManyMicrons, \
$CellContext`yOnePixelIsSoManyMicrons, $CellContext`zOnePixelIsSoManyMicrons, \
$CellContext`fd2]; $CellContext`rofun2 = \
$CellContext`FitDeformed[$CellContext`PC2]; $CellContext`Vol2 = \
$CellContext`ComputeVol2[$CellContext`rofun2]; $CellContext`DeformedShape2[
       Pattern[$CellContext`\[Theta]1, 
        Blank[]], 
       Pattern[$CellContext`\[Phi]1, 
        Blank[]]] = 
     ReplaceAll[$CellContext`rofun2, {$CellContext`\[Theta] -> $CellContext`\
\[Theta]1, $CellContext`\[Phi] -> $CellContext`\[Phi]1}]; \
$CellContext`cell2Surface = 
     ParametricPlot3D[$CellContext`DeformedShape2[$CellContext`\[Theta], \
$CellContext`\[Phi]] {
        Sin[$CellContext`\[Theta]] Cos[$CellContext`\[Phi]], 
         Sin[$CellContext`\[Theta]] Sin[$CellContext`\[Phi]], 
         Cos[$CellContext`\[Theta]]}, {$CellContext`\[Theta], 0, 
        Pi}, {$CellContext`\[Phi], 0, 2 Pi}, PlotStyle -> {Blue, 
         Opacity[0.2]}]; $CellContext`cell2Points = 
     ListPointPlot3D[{$CellContext`PC2}, PlotStyle -> {Black, 
         Opacity[
         1.]}]; $CellContext`Plt2 = \
$CellContext`PlotFitting[$CellContext`cell2Surface, $CellContext`cell2Points, 
       Part[$CellContext`StrList, 
        2]]; $CellContext`InitializeFEM; {$CellContext`PltMesh, \
$CellContext`PltTraction, $CellContext`prIdShellAvg, \
$CellContext`WorkDoneIdShell} = $CellContext`FEMResult[
       Part[$CellContext`StrList, 
        2], $CellContext`r1, $CellContext`rofun2]; $CellContext`NameList = {
      "Reference Volume (\!\(\*SuperscriptBox[\(\[Micro]m\), \(3\)]\))", 
       "Deformed Volume (\!\(\*SuperscriptBox[\(\[Micro]m\), \(3\)]\))", 
       "Average Pressure (Pa)", 
       "Elastic Energy (\[Micro]J)"}; $CellContext`NumList = \
{$CellContext`Vol1, $CellContext`Vol2, $CellContext`prIdShellAvg, \
$CellContext`WorkDoneIdShell}; $CellContext`data = 
     Transpose[{$CellContext`NameList, $CellContext`NumList}]; \
$CellContext`to = Grid[$CellContext`data, Background -> {None, {
          Lighter[Yellow, 0.9], {White, 
           Lighter[
            Blend[{Blue, Green}], 0.8]}}}, Dividers -> {{
          Darker[Gray, 0.6], {
           Lighter[Gray, 0.5]}, 
          Darker[Gray, 0.6]}, {
          Darker[Gray, 0.6], 
          Darker[Gray, 0.6], {False}, 
          Darker[Gray, 0.6]}}, Alignment -> {{Left, Right, {Left}}}, 
       ItemSize -> {{10, 3, 5, 5}}, Frame -> Darker[Gray, 0.6], ItemStyle -> 
       14, Spacings -> {
        Automatic, 
         0.8}]; {$CellContext`Plt1, $CellContext`Plt2, $CellContext`PltMesh, \
$CellContext`PltTraction, $CellContext`to}]& , "CloudCDF"],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.782062386650653*^9, 3.782062452572551*^9},
 CellLabel->
  "(L2) Out[194]=",ExpressionUUID->"bfe7b293-9683-4d54-98e2-626b1b7669c5"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.782061846463325*^9},ExpressionUUID->"3aa08bef-60d2-4f91-9d30-\
17e1bda90e80"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CloudDeploy", "[", 
  RowBox[{"ImgProcess2", ",", 
   RowBox[{
   "CloudObject", "[", 
    "\"\<https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/FullVersion_\
V2\>\"", "]"}], ",", 
   RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.782062395749736*^9, 3.782062405894231*^9}},
 CellLabel->
  "(L2) In[195]:=",ExpressionUUID->"a4573396-1164-4e48-95e2-dacf1b2e71a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"CloudObject", "[", 
   TemplateBox[{
    "\"https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/FullVersion_V2\
\"","https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/FullVersion_V2"},
    "HyperlinkURL"], "]"}],
  CloudObject[
  "https://www.wolframcloud.com/obj/wenqiang_fang/HCP_test/FullVersion_V2"],
  SelectWithContents->True]], "Output",
 CellChangeTimes->{3.782062407707334*^9, 3.782062456303681*^9},
 CellLabel->
  "(L2) Out[195]=",ExpressionUUID->"7889852d-5ef8-4069-b081-f52cf9f471fd"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{2560, 1337},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 208, 4, 46, "Input",ExpressionUUID->"003d715c-a79f-4b7a-9c93-c3c61350de14"],
Cell[791, 28, 304, 5, 52, "Output",ExpressionUUID->"54de4ce0-8551-4c62-b745-7bdd05b4117d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1132, 38, 187, 2, 46, "Input",ExpressionUUID->"1aca87b8-a358-400b-a77a-afcee46266ae"],
Cell[1322, 42, 490, 7, 52, "Output",ExpressionUUID->"ac558873-8f90-41f1-8d5b-0f1d53ceb299"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1849, 54, 192, 2, 46, "Input",ExpressionUUID->"47921a87-878e-489c-a894-d4b505ec15a9"],
Cell[2044, 58, 270, 4, 52, "Output",ExpressionUUID->"b49e42ba-33b0-4fa3-9c9b-0379fcd196a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2351, 67, 225, 4, 101, "Section",ExpressionUUID->"bccfd88a-5f22-490f-8dea-d1cc1ddd9b96"],
Cell[CellGroupData[{
Cell[2601, 75, 161, 3, 81, "Subsection",ExpressionUUID->"541c662f-363c-42fe-a9b2-488d5947384e"],
Cell[2765, 80, 12367, 316, 1356, "Input",ExpressionUUID->"5e739396-8407-44d4-8342-81db78a5f878"],
Cell[15135, 398, 57425, 1436, 4751, "Input",ExpressionUUID->"2cb0b255-1f61-42f8-a187-c6116a36faa0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72597, 1839, 161, 3, 81, "Subsection",ExpressionUUID->"ca84d23b-105a-4bdc-b780-2be0432aee5a"],
Cell[72761, 1844, 12717, 246, 1169, "Input",ExpressionUUID->"3ea47407-8239-4d63-9d7c-64eab4b44e52"],
Cell[CellGroupData[{
Cell[85503, 2094, 738, 14, 46, "Input",ExpressionUUID->"cec1e147-d6a2-4638-97e7-d084c55607eb"],
Cell[86244, 2110, 2285, 37, 56, "Output",ExpressionUUID->"cf48994e-3cf0-49d4-8b6d-e24caa631fa0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88566, 2152, 197, 3, 46, "Input",ExpressionUUID->"6f3c6bd2-badd-4614-95f1-4f09f5233c3d"],
Cell[88766, 2157, 553, 9, 52, "Output",ExpressionUUID->"058a9009-9868-4335-bbfd-1cf5054a1d29"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[89368, 2172, 179, 3, 81, "Subsection",ExpressionUUID->"236fa205-d28f-44bf-bc44-660716bfa744"],
Cell[CellGroupData[{
Cell[89572, 2179, 15887, 320, 1344, "Input",ExpressionUUID->"7f59b6ba-5ffd-4fa6-b291-6c815abd2411"],
Cell[105462, 2501, 11995, 232, 385, "Output",ExpressionUUID->"bfe7b293-9683-4d54-98e2-626b1b7669c5"]
}, Open  ]],
Cell[117472, 2736, 128, 3, 46, "Input",ExpressionUUID->"3aa08bef-60d2-4f91-9d30-17e1bda90e80"],
Cell[CellGroupData[{
Cell[117625, 2743, 441, 10, 63, "Input",ExpressionUUID->"a4573396-1164-4e48-95e2-dacf1b2e71a9"],
Cell[118069, 2755, 551, 12, 73, "Output",ExpressionUUID->"7889852d-5ef8-4069-b081-f52cf9f471fd"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

