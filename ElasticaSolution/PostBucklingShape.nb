(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30289,        818]
NotebookOptionsPosition[     26771,        763]
NotebookOutlinePosition[     27670,        790]
CellTagsIndexPosition[     27627,        787]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Elastica deformed configuration",
 FontFamily->"Times New Roman",
 FontSize->36,
 FontWeight->"Regular"]], "Title",ExpressionUUID->"faef9ad5-1fce-47ba-a23c-\
49e1964b1d52"],

Cell[BoxData[{
 RowBox[{"<<", "MaTeX`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Notation`"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", 
  RowBox[{"\"\<ComplexSymbols`\>\"", ",", " ", 
   RowBox[{"URLDownload", "[", 
    TagBox[
     StyleBox[
      "\"\<https://www.dropbox.com/s/jilor1vs7b78tqh/ComplexSymbols.wl?raw=1\>\
\"",
      ShowSpecialCharacters->False,
      ShowStringCharacters->True,
      NumberMarks->True],
     FullForm], "]"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->"In[41]:=",ExpressionUUID->"252dcb2d-61f8-4f65-b4e0-14cef6010747"],

Cell[BoxData[""], "Input",ExpressionUUID->"f9844c66-cef0-4725-9a54-3b49c4958ead"],

Cell[TextData[StyleBox["",
 FontSize->24]], "Text",ExpressionUUID->"bdeaa4f1-738b-4021-abb6-a10d0e71accc"],

Cell[BoxData[
 RowBox[{"SymbolPalette", "[", 
  RowBox[{"\"\<syms\>\"", ",", "syms", ",", "1"}], "]"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"32ed988c-d98d-43eb-a9a9-4c512a029867"],

Cell[BoxData[
 RowBox[{"syms", "=", 
  RowBox[{"AssignLabels", "[", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\!\(\*StyleBox[\"\[Theta]\",FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\>\"", ",", 
     "\"\<\!\(\*StyleBox[\"\[Theta]\",FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\!\(\*StyleBox[\"'\",\
FontFamily->\"Times New Roman\",FontSize->18,FontWeight->\"Regular\"]\)\>\"", 
     ",", "\"\<\!\(\*StyleBox[\"\[Theta]$\",FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\>\"", ",", 
     "\"\<\!\(\*StyleBox[\"\[Theta]\",FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\!\(\*StyleBox[\"'\",\
FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\!\(\*StyleBox[\"$\",\
FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\>\""}], "}"}], 
   "]"}]}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"5e623d39-21f3-4145-b16b-807e6dbd4c00"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    TemplateBox[{
     "\"\!\(\*StyleBox[\"\[Theta]\",FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\""},
     "complexSymbols",
     Editable->False,
     Selectable->False], "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"The\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\" \
\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"angle\",FontWeight->\"Plain\"]\)\!\
\(\*StyleBox[\" \
\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"that\",FontWeight->\"Plain\"]\)\!\
\(\*StyleBox[\" \
\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"the\",FontWeight->\"Plain\"]\)\!\(\
\*StyleBox[\" \
\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"tangent\",FontWeight->\"Plain\"]\)\
\!\(\*StyleBox[\" \
\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"to\",FontWeight->\"Plain\"]\)\!\(\
\*StyleBox[\" \
\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"the\",FontWeight->\"Plain\"]\)\!\(\
\*StyleBox[\" \
\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"neutral\",FontWeight->\"Plain\"]\)\
\!\(\*StyleBox[\" \
\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"axis\",FontWeight->\"Plain\"]\)\!\
\(\*StyleBox[\" \
\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"makes\",FontWeight->\"Plain\"]\)\!\
\(\*StyleBox[\" \
\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"with\",FontWeight->\"Plain\"]\) \
\!\(\*SubscriptBox[StyleBox[\"e\",FontWeight->\"Bold\"], \"1\"]\).\>\""}]}]], \
"Input",ExpressionUUID->"a4600c7f-a3ec-4754-96f7-17c1cd975ef9"],

Cell[BoxData[
 RowBox[{"sol\[Theta]", "=", " ", 
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         TemplateBox[{
          "\"\!\(\*StyleBox[\"\[Theta]\",FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\""},
          "complexSymbols",
          Editable->False,
          Selectable->False], "''"}], "[", "s", "]"}], "+", 
       RowBox[{"p", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          
          TemplateBox[{
           "\"\!\(\*StyleBox[\"\[Theta]\",FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\""},
           "complexSymbols",
           Editable->False,
           Selectable->False], "[", "s", "]"}], "]"}]}]}], "\[Equal]", "0"}], 
     "}"}], ",", 
    RowBox[{
     TemplateBox[{
      "\"\!\(\*StyleBox[\"\[Theta]\",FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\""},
      "complexSymbols",
      Editable->False,
      Selectable->False], "[", "s", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"91c56ea1-a466-4310-be27-3a3ee68f6733"],

Cell[BoxData[
 RowBox[{"sol\[Theta]", "=", " ", 
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "''"}], "[", "s", "]"}], "+", 
        RowBox[{"10", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}]}], "\[Equal]", "0"}], 
      ",", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "1", "]"}], "\[Equal]", "0"}]}], 
     "}"}], ",", 
    RowBox[{"\[Theta]", "[", "s", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"c083e4b3-dbb0-434d-b79a-60ad0a735e01"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
    "\"\!\(\*StyleBox[\"\[Theta]$\",FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\""},
    "complexSymbols",
    Editable->False,
    Selectable->False], " ", "[", "s_", "]"}], "=", " ", 
  RowBox[{
   RowBox[{
    TemplateBox[{
     "\"\!\(\*StyleBox[\"\[Theta]\",FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\""},
     "complexSymbols",
     Editable->False,
     Selectable->False], "[", "s", "]"}], "/.", 
   RowBox[{"sol\[Theta]", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"97d4a400-0c36-4a7c-b16d-c880540325f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
    "\"\!\(\*StyleBox[\"\[Theta]\",FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\!\(\*StyleBox[\"'\",\
FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\!\(\*StyleBox[\"$\",\
FontFamily->\"Times New Roman\",FontSize->18,FontWeight->\"Regular\"]\)\""},
    "complexSymbols",
    Editable->False,
    Selectable->False], "[", "s_", "]"}], "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     TemplateBox[{
      "\"\!\(\*StyleBox[\"\[Theta]$\",FontFamily->\"Times New \
Roman\",FontSize->18,FontWeight->\"Regular\"]\)\""},
      "complexSymbols",
      Editable->False,
      Selectable->False], " ", "[", "s", "]"}], ",", "s"}], "]"}]}]], "Input",\

 CellLabel->"In[21]:=",ExpressionUUID->"0b0d5aaf-d4f1-4971-ac6e-0dacf94702aa"],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]temp1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{"C", "[", "1", "]"}]}], "]"}]], "Input",
 CellLabel->
  "In[135]:=",ExpressionUUID->"d7b78138-4c08-415d-834b-9358b14d8b68"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", "=", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"JacobiAmplitude", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "p"}], "+", 
              RowBox[{"C", "[", "1", "]"}]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"s", "+", 
               RowBox[{"C", "[", "2", "]"}]}], ")"}], "2"]}]]}], ",", 
         FractionBox[
          RowBox[{"4", " ", "p"}], 
          RowBox[{
           RowBox[{"2", " ", "p"}], "+", 
           RowBox[{"C", "[", "1", "]"}]}]]}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Rule]", "1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[143]:=",ExpressionUUID->"cae0ff82-c32e-438f-bcd3-10feaa6f6b6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]", "[", "s_", "]"}], "=", 
  RowBox[{"2", " ", 
   RowBox[{"ArcSin", "[", 
    RowBox[{
     RowBox[{"Sqrt", "[", "kn", "]"}], " ", 
     RowBox[{"JacobiSN", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"s", " ", 
         RowBox[{"Sqrt", "[", "p", "]"}]}], "+", 
        RowBox[{"EllipticK", "[", "kn", "]"}]}], ",", "kn"}], "]"}]}], "]"}], 
   " ", 
   RowBox[{"(*", 
    RowBox[{"From", " ", 
     RowBox[{"Love", "'"}], "s", " ", "book"}], "*)"}]}]}]], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"06b046e0-4064-4164-9724-4821b7b41253"],

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"\[Theta]", "[", "s", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "2"}], "}"}]}], "]"}], "//", "FullSimplify"}]], "Input",\

 CellLabel->"In[39]:=",ExpressionUUID->"f66fec67-c8c1-49ee-9e50-0f295e10c765"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", "=", " ", 
      RowBox[{
       SuperscriptBox["\[Pi]", "2"], "+", "0.1"}]}], ",", "solk", ",", "kn", 
     ",", "\[Theta]", ",", "\[Theta]2", ",", "soly", ",", "solx"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solk", " ", "=", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EllipticK", "[", "x", "]"}], "-", 
        RowBox[{
         RowBox[{"Sqrt", "[", "p", "]"}], "/", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"kn", " ", "=", 
     RowBox[{"x", "/.", "solk"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "kn", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LeftE", "[", "s_", "]"}], "=", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "kn"}], ")"}], "2"], " ", 
        SqrtBox["kn"], " ", "p", " ", 
        RowBox[{"JacobiCN", "[", 
         RowBox[{
          RowBox[{
           SqrtBox["p"], " ", "s"}], ",", "kn"}], "]"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"kn", " ", 
            SuperscriptBox[
             RowBox[{"JacobiCD", "[", 
              RowBox[{
               RowBox[{
                SqrtBox["p"], " ", "s"}], ",", "kn"}], "]"}], "2"]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", 
        SuperscriptBox[
         RowBox[{"JacobiDN", "[", 
          RowBox[{
           RowBox[{
            SqrtBox["p"], " ", "s"}], ",", "kn"}], "]"}], "5"]}]]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RightE", "[", "s_", "]"}], "=", 
     RowBox[{
      RowBox[{"-", " ", "p"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"ArcSin", "[", 
         RowBox[{
          SqrtBox["kn"], " ", 
          RowBox[{"JacobiCD", "[", 
           RowBox[{
            RowBox[{
             SqrtBox["p"], " ", "s"}], ",", "kn"}], "]"}]}], "]"}]}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"LeftE", "[", "s", "]"}], "-", 
       RowBox[{"RightE", "[", "s", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"99125f90-cf86-4dc4-\
8fa7-751c2a9cf474"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PAna", "[", "P_", "]"}], ":=", 
  RowBox[{"Reap", "@", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "solk", ",", "kn", ",", "\[Theta]", ",", "\[Theta]2", ",", "soly", ",", 
       "solx"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"solk", " ", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"EllipticK", "[", "x", "]"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"Sqrt", "[", "P", "]"}], "/", "2"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kn", " ", "=", 
       RowBox[{"x", "/.", "solk"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "s_", "]"}], "=", 
       RowBox[{"2", 
        RowBox[{"ArcSin", "[", 
         RowBox[{
          RowBox[{"Sqrt", "[", "kn", "]"}], " ", 
          RowBox[{"JacobiSN", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"s", " ", 
              RowBox[{"Sqrt", "[", "P", "]"}]}], "+", 
             RowBox[{"EllipticK", "[", "kn", "]"}]}], ",", "kn"}], "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solx", " ", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "'"}], "[", "s", "]"}], "==", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"x", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"soly", "=", " ", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"y", "'"}], "[", "s", "]"}], "\[Equal]", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"y", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dflection", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", "s", "]"}], "/.", 
         RowBox[{"soly", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
        RowBox[{"s", "\[Rule]", 
         RowBox[{"1", "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sow", "[", "dflection", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "s", "]"}], "/.", 
           RowBox[{"solx", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"y", "[", "s", "]"}], "/.", 
           RowBox[{"soly", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", "Dashed", "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellLabel->"In[46]:=",ExpressionUUID->"1319a9b2-614e-4ebf-9c65-9601c6ad315d"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[Pi]", "2"], "//", "N"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"f0a3816c-cd14-4b20-8432-10bf095f830c"],

Cell[BoxData[
 RowBox[{"PAna", "[", "9.9", "]"}]], "Input",
 CellLabel->"In[47]:=",ExpressionUUID->"6347902f-36d0-4802-9150-f29f8d8bf9b3"],

Cell[BoxData[
 RowBox[{"PAna", "[", "11", "]"}]], "Input",
 CellLabel->
  "In[197]:=",ExpressionUUID->"0ad58dc7-3a4f-49ac-9a08-5e385fc96d6e"],

Cell[BoxData[
 RowBox[{"PAna", "[", "21", "]"}]], "Input",
 CellLabel->
  "In[198]:=",ExpressionUUID->"dd4c66cc-3176-487f-844b-d4ab0576440e"],

Cell[BoxData[
 RowBox[{"Clear", "[", "P", "]"}]], "Input",
 CellLabel->
  "In[196]:=",ExpressionUUID->"be8e509e-efcb-47a8-9d52-f16b45faab2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PShape", "[", "P_", "]"}], ":=", 
  RowBox[{"Reap", "@", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"solk", ",", "kn", ",", "soly", ",", "solx"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"solk", " ", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"EllipticK", "[", "k", "]"}], "-", 
          RowBox[{
           RowBox[{"Sqrt", "[", "P", "]"}], "/", "2"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kn", " ", "=", 
       RowBox[{"k", "/.", "solk"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "s_", "]"}], "=", 
       RowBox[{"2", 
        RowBox[{"ArcSin", "[", 
         RowBox[{
          RowBox[{"Sqrt", "[", "kn", "]"}], " ", 
          RowBox[{"JacobiSN", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"s", " ", 
              RowBox[{"Sqrt", "[", "P", "]"}]}], "+", 
             RowBox[{"EllipticK", "[", "kn", "]"}]}], ",", "kn"}], "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"solx", " ", "=", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x", "'"}], "[", "s", "]"}], "==", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
           RowBox[{"x", "[", "s", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"soly", "=", " ", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"y", "'"}], "[", "s", "]"}], "\[Equal]", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
           RowBox[{"y", "[", "s", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "[", "s_", "]"}], "=", 
       RowBox[{
        RowBox[{"-", "s"}], "+", 
        RowBox[{
         FractionBox["2", 
          RowBox[{"Sqrt", "[", "P", "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"EllipticE", "[", 
            RowBox[{
             RowBox[{"JacobiAmplitude", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"s", " ", 
                 RowBox[{"Sqrt", "[", "P", "]"}]}], "+", 
                RowBox[{"EllipticK", "[", "kn", "]"}]}], ",", "kn"}], "]"}], 
             ",", "kn"}], "]"}], "-", 
           RowBox[{"EllipticE", "[", 
            RowBox[{
             RowBox[{"JacobiAmplitude", "[", 
              RowBox[{
               RowBox[{"EllipticK", "[", "kn", "]"}], ",", "kn"}], "]"}], ",",
              "kn"}], "]"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"y", "[", "s_", "]"}], "=", 
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        FractionBox[
         RowBox[{
          RowBox[{"Sqrt", "[", "kn", "]"}], " "}], 
         RowBox[{"Sqrt", "[", "P", "]"}]], 
        RowBox[{"JacobiCN", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s", " ", 
            RowBox[{"Sqrt", "[", "P", "]"}]}], "+", 
           RowBox[{"EllipticK", "[", "kn", "]"}]}], ",", "kn"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dflection", " ", "=", " ", 
       RowBox[{
        RowBox[{"y", "[", "s", "]"}], "/.", 
        RowBox[{"s", "\[Rule]", 
         RowBox[{"1", "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sow", "[", "dflection", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{"x", "[", "s", "]"}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "6"}]]}], "]"}], ",", 
          RowBox[{"y", "[", "s", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", "Dashed", "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellLabel->
  "In[201]:=",ExpressionUUID->"53c57faa-7361-4aa9-8602-e3020cebd8b4"],

Cell[BoxData[
 RowBox[{"PShape", "[", "11", "]"}]], "Input",
 CellLabel->
  "In[202]:=",ExpressionUUID->"8175582d-05b8-403d-930e-2fad441a10f2"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"\[Theta]", ",", "x", ",", "y"}], "]"}]], "Input",
 CellLabel->
  "In[208]:=",ExpressionUUID->"d844674e-9174-4fa5-8373-888a3156b615"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MMSFull", "[", "P0_", "]"}], ":=", 
  RowBox[{"Reap", "@", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", " ", "=", " ", "P0"}], ",", "solMM", ",", "MM\[Theta]2", 
       ",", "solx", ",", "soly", ",", "dflection"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"solMM", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[Theta]", "''"}], "[", "s", "]"}], "+", 
             RowBox[{"P", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}]}], "\[Equal]", 
            "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "'"}], "[", "1", "]"}], "\[Equal]", "0"}]}], 
          "}"}], ",", 
         RowBox[{"\[Theta]", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"solx", " ", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "'"}], "[", "s", "]"}], "==", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"\[Theta]", "[", "s", "]"}], "/.", 
              RowBox[{"solMM", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"x", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"soly", "=", " ", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"y", "'"}], "[", "s", "]"}], "\[Equal]", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Theta]", "[", "s", "]"}], "/.", 
              RowBox[{"solMM", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"y", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dflection", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", "s", "]"}], "/.", 
         RowBox[{"soly", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
        RowBox[{"s", "\[Rule]", 
         RowBox[{"1", "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sow", "[", "dflection", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "s", "]"}], "/.", 
           RowBox[{"solx", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"y", "[", "s", "]"}], "/.", 
           RowBox[{"soly", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Dashed", ",", 
           RowBox[{
            RowBox[{"ColorData", "[", "2", "]"}], "[", "1", "]"}], ",", 
           RowBox[{"Thickness", "[", "0.003", "]"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellLabel->
  "In[209]:=",ExpressionUUID->"95d78800-c73d-4019-9ece-36e42112ea01"],

Cell[BoxData[
 RowBox[{"MMSFull", "[", "11", "]"}]], "Input",
 CellLabel->
  "In[210]:=",ExpressionUUID->"488630b2-a50c-4016-9778-ad862b80de56"],

Cell[BoxData[""], "Input",ExpressionUUID->"4271fcad-b0a9-4e18-954f-3c8b7ad394b5"],

Cell[BoxData[
 RowBox[{"MMSFull", "[", "9.9", "]"}]], "Input",
 CellLabel->
  "In[211]:=",ExpressionUUID->"4339f635-beea-41b8-8cd7-895adcf82f91"]
}, Open  ]]
},
WindowSize->{952, 1005},
WindowMargins->{{128, Automatic}, {Automatic, 0}},
TrackCellChangeTimes->False,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["complexSymbols"], ShowAutoStyles -> False, 
    ShowStringCharacters -> False, ZeroWidthTimes -> True, StyleMenuListing -> 
    None, FontFamily -> "Times", FontWeight -> Plain, 
    TagBoxOptions -> {SyntaxForm -> "symbol"}, 
    TemplateBoxOptions -> {
     DisplayFunction -> (RowBox[{#}]& ), SyntaxForm -> "symbol"}]}, Visible -> 
  False, FrontEndVersion -> "12.0 for Mac OS X x86 (64-bit) (April 8, 2019)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 196, 4, 81, "Title",ExpressionUUID->"faef9ad5-1fce-47ba-a23c-49e1964b1d52"],
Cell[779, 28, 576, 14, 115, "Input",ExpressionUUID->"252dcb2d-61f8-4f65-b4e0-14cef6010747"],
Cell[1358, 44, 81, 0, 30, "Input",ExpressionUUID->"f9844c66-cef0-4725-9a54-3b49c4958ead"],
Cell[1442, 46, 106, 1, 46, "Text",ExpressionUUID->"bdeaa4f1-738b-4021-abb6-a10d0e71accc"],
Cell[1551, 49, 191, 3, 30, "Input",ExpressionUUID->"32ed988c-d98d-43eb-a9a9-4c512a029867"],
Cell[1745, 54, 984, 19, 34, "Input",ExpressionUUID->"5e623d39-21f3-4145-b16b-807e6dbd4c00"],
Cell[2732, 75, 1469, 31, 52, "Input",ExpressionUUID->"a4600c7f-a3ec-4754-96f7-17c1cd975ef9"],
Cell[4204, 108, 1217, 35, 33, "Input",ExpressionUUID->"91c56ea1-a466-4310-be27-3a3ee68f6733"],
Cell[5424, 145, 792, 23, 30, "Input",ExpressionUUID->"c083e4b3-dbb0-434d-b79a-60ad0a735e01"],
Cell[6219, 170, 678, 19, 31, "Input",ExpressionUUID->"97d4a400-0c36-4a7c-b16d-c880540325f6"],
Cell[6900, 191, 835, 22, 34, "Input",ExpressionUUID->"0b0d5aaf-d4f1-4971-ac6e-0dacf94702aa"],
Cell[7738, 215, 266, 7, 30, "Input",ExpressionUUID->"d7b78138-4c08-415d-834b-9358b14d8b68"],
Cell[8007, 224, 1287, 39, 108, "Input",ExpressionUUID->"cae0ff82-c32e-438f-bcd3-10feaa6f6b6f"],
Cell[9297, 265, 595, 17, 30, "Input",ExpressionUUID->"06b046e0-4064-4164-9724-4821b7b41253"],
Cell[9895, 284, 282, 8, 30, "Input",ExpressionUUID->"f66fec67-c8c1-49ee-9e50-0f295e10c765"],
Cell[10180, 294, 2572, 77, 242, "Input",ExpressionUUID->"99125f90-cf86-4dc4-8fa7-751c2a9cf474"],
Cell[12755, 373, 3621, 96, 241, "Input",ExpressionUUID->"1319a9b2-614e-4ebf-9c65-9601c6ad315d"],
Cell[16379, 471, 156, 3, 30, "Input",ExpressionUUID->"f0a3816c-cd14-4b20-8432-10bf095f830c"],
Cell[16538, 476, 138, 2, 30, "Input",ExpressionUUID->"6347902f-36d0-4802-9150-f29f8d8bf9b3"],
Cell[16679, 480, 141, 3, 30, "Input",ExpressionUUID->"0ad58dc7-3a4f-49ac-9a08-5e385fc96d6e"],
Cell[16823, 485, 141, 3, 30, "Input",ExpressionUUID->"dd4c66cc-3176-487f-844b-d4ab0576440e"],
Cell[16967, 490, 141, 3, 30, "Input",ExpressionUUID->"be8e509e-efcb-47a8-9d52-f16b45faab2f"],
Cell[17111, 495, 4923, 132, 408, "Input",ExpressionUUID->"53c57faa-7361-4aa9-8602-e3020cebd8b4"],
Cell[22037, 629, 143, 3, 30, "Input",ExpressionUUID->"8175582d-05b8-403d-930e-2fad441a10f2"],
Cell[22183, 634, 184, 4, 30, "Input",ExpressionUUID->"d844674e-9174-4fa5-8373-888a3156b615"],
Cell[22370, 640, 4006, 108, 199, "Input",ExpressionUUID->"95d78800-c73d-4019-9ece-36e42112ea01"],
Cell[26379, 750, 144, 3, 30, "Input",ExpressionUUID->"488630b2-a50c-4016-9778-ad862b80de56"],
Cell[26526, 755, 81, 0, 30, "Input",ExpressionUUID->"4271fcad-b0a9-4e18-954f-3c8b7ad394b5"],
Cell[26610, 757, 145, 3, 30, "Input",ExpressionUUID->"4339f635-beea-41b8-8cd7-895adcf82f91"]
}, Open  ]]
}
]
*)

