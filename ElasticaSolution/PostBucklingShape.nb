(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29066,        775]
NotebookOptionsPosition[     26518,        738]
NotebookOutlinePosition[     26855,        753]
CellTagsIndexPosition[     26812,        750]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Elastica deformed configuration", "Text",
 CellChangeTimes->{{3.781214883019999*^9, 
  3.781214889902534*^9}},ExpressionUUID->"faef9ad5-1fce-47ba-a23c-\
49e1964b1d52"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"sol\[Theta]", "=", " ", 
   RowBox[{"DSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "''"}], "[", "s", "]"}], "+", 
        RowBox[{"p", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}]}], "\[Equal]", "0"}], 
      "}"}], ",", 
     RowBox[{"\[Theta]", "[", "s", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.771590872262989*^9, 3.7715910570349092`*^9}, {
   3.771591535422181*^9, 3.7715915390657873`*^9}, 
   3.781214876388555*^9},ExpressionUUID->"a4600c7f-a3ec-4754-96f7-\
17c1cd975ef9"],

Cell[BoxData[
 RowBox[{"sol\[Theta]", "=", " ", 
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "''"}], "[", "s", "]"}], "+", 
        RowBox[{"10", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}]}], "\[Equal]", "0"}], 
      ",", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "1", "]"}], "\[Equal]", "0"}]}], 
     "}"}], ",", 
    RowBox[{"\[Theta]", "[", "s", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.771591545950437*^9, 3.771591565761257*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"c083e4b3-dbb0-434d-b79a-60ad0a735e01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]temp1", " ", "[", "s_", "]"}], "=", " ", 
  RowBox[{
   RowBox[{"\[Theta]", "[", "s", "]"}], "/.", 
   RowBox[{"sol\[Theta]", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.771591042004303*^9, 3.771591120629651*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"97d4a400-0c36-4a7c-b16d-c880540325f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]temp1D", "[", "s_", "]"}], "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"\[Theta]temp1", "[", "s", "]"}], ",", "s"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.771591126390678*^9, 3.771591177309606*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"0b0d5aaf-d4f1-4971-ac6e-0dacf94702aa"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", "=", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"NSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]temp1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]temp1D", "[", "1", "]"}], "\[Equal]", "0"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], ",", 
       RowBox[{"C", "[", "2", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7715911823983927`*^9, 3.771591228765532*^9}, {
  3.771591311468644*^9, 3.771591356521517*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"9e0acb97-15d2-43ba-81cd-2aa990867155"],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]temp1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{"C", "[", "1", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.771591281777899*^9, 3.771591306159343*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"d7b78138-4c08-415d-834b-9358b14d8b68"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", "=", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"JacobiAmplitude", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "p"}], "+", 
              RowBox[{"C", "[", "1", "]"}]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"s", "+", 
               RowBox[{"C", "[", "2", "]"}]}], ")"}], "2"]}]]}], ",", 
         FractionBox[
          RowBox[{"4", " ", "p"}], 
          RowBox[{
           RowBox[{"2", " ", "p"}], "+", 
           RowBox[{"C", "[", "1", "]"}]}]]}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Rule]", "1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.771591392518018*^9, 3.771591467899293*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"cae0ff82-c32e-438f-bcd3-10feaa6f6b6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]", "[", "s_", "]"}], "=", 
  RowBox[{"2", " ", 
   RowBox[{"ArcSin", "[", 
    RowBox[{
     RowBox[{"Sqrt", "[", "kn", "]"}], " ", 
     RowBox[{"JacobiSN", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"s", " ", 
         RowBox[{"Sqrt", "[", "p", "]"}]}], "+", 
        RowBox[{"EllipticK", "[", "kn", "]"}]}], ",", "kn"}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7715916434081497`*^9, 3.771591707343328*^9}, {
  3.7716006669107924`*^9, 3.771600670303453*^9}, {3.771600908525589*^9, 
  3.771600912696396*^9}, {3.771600943208478*^9, 3.77160094672866*^9}, {
  3.771601659423174*^9, 3.771601667058475*^9}, {3.771677284402425*^9, 
  3.771677305584992*^9}, {3.771677407109281*^9, 3.7716774098268538`*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"06b046e0-4064-4164-9724-4821b7b41253"],

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"\[Theta]", "[", "s", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "2"}], "}"}]}], "]"}], "//", "FullSimplify"}]], "Input",\

 CellChangeTimes->{{3.77159171926612*^9, 3.771591753450445*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"f66fec67-c8c1-49ee-9e50-0f295e10c765"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sin", "[", 
   RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.771591853758915*^9, 3.771591857126855*^9}, {
  3.771591933065127*^9, 3.771591935356369*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"fe7bfa7f-b800-4c26-8779-00f9e7ac67b7"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", "=", " ", 
      RowBox[{
       SuperscriptBox["\[Pi]", "2"], "+", "0.1"}]}], ",", "solk", ",", "kn", 
     ",", "\[Theta]", ",", "\[Theta]2", ",", "soly", ",", "solx"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solk", " ", "=", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EllipticK", "[", "x", "]"}], "-", 
        RowBox[{
         RowBox[{"Sqrt", "[", "p", "]"}], "/", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"kn", " ", "=", 
     RowBox[{"x", "/.", "solk"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "kn", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LeftE", "[", "s_", "]"}], "=", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "kn"}], ")"}], "2"], " ", 
        SqrtBox["kn"], " ", "p", " ", 
        RowBox[{"JacobiCN", "[", 
         RowBox[{
          RowBox[{
           SqrtBox["p"], " ", "s"}], ",", "kn"}], "]"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"kn", " ", 
            SuperscriptBox[
             RowBox[{"JacobiCD", "[", 
              RowBox[{
               RowBox[{
                SqrtBox["p"], " ", "s"}], ",", "kn"}], "]"}], "2"]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", 
        SuperscriptBox[
         RowBox[{"JacobiDN", "[", 
          RowBox[{
           RowBox[{
            SqrtBox["p"], " ", "s"}], ",", "kn"}], "]"}], "5"]}]]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RightE", "[", "s_", "]"}], "=", 
     RowBox[{
      RowBox[{"-", " ", "p"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"ArcSin", "[", 
         RowBox[{
          SqrtBox["kn"], " ", 
          RowBox[{"JacobiCD", "[", 
           RowBox[{
            RowBox[{
             SqrtBox["p"], " ", "s"}], ",", "kn"}], "]"}]}], "]"}]}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"RightE", "[", "s_", "]"}], "=", 
       RowBox[{
        RowBox[{"-", "p"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"ArcSin", "[", 
           RowBox[{"kn", " ", 
            RowBox[{"JacobiCD", "[", 
             RowBox[{
              RowBox[{
               SqrtBox["p"], " ", "s"}], ",", "kn"}], "]"}]}], "]"}]}], 
         "]"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"LeftE", "[", "s", "]"}], "-", 
       RowBox[{"RightE", "[", "s", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.771591975597546*^9, 3.771591998856879*^9}, {
   3.771592045488899*^9, 3.7715921291655483`*^9}, {3.771592446418392*^9, 
   3.771592484170795*^9}, 3.771600761717431*^9, {3.77160171872556*^9, 
   3.7716017199137487`*^9}, {3.7716017833416233`*^9, 3.771601787549903*^9}, {
   3.771601882550378*^9, 3.771601890723016*^9}, {3.7716020123888893`*^9, 
   3.7716020138897247`*^9}, {3.771677360578044*^9, 3.771677366484157*^9}, {
   3.7716774760754013`*^9, 3.771677489298759*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"99125f90-cf86-4dc4-8fa7-751c2a9cf474"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PAna", "[", "P_", "]"}], ":=", 
  RowBox[{"Reap", "@", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "solk", ",", "kn", ",", "\[Theta]", ",", "\[Theta]2", ",", "soly", ",", 
       "solx"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"solk", " ", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"EllipticK", "[", "x", "]"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"Sqrt", "[", "P", "]"}], "/", "2"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kn", " ", "=", 
       RowBox[{"x", "/.", "solk"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "s_", "]"}], "=", 
       RowBox[{"2", 
        RowBox[{"ArcSin", "[", 
         RowBox[{
          RowBox[{"Sqrt", "[", "kn", "]"}], " ", 
          RowBox[{"JacobiSN", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"s", " ", 
              RowBox[{"Sqrt", "[", "P", "]"}]}], "+", 
             RowBox[{"EllipticK", "[", "kn", "]"}]}], ",", "kn"}], "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solx", " ", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "'"}], "[", "s", "]"}], "==", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"x", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"soly", "=", " ", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"y", "'"}], "[", "s", "]"}], "\[Equal]", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"y", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dflection", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", "s", "]"}], "/.", 
         RowBox[{"soly", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
        RowBox[{"s", "\[Rule]", 
         RowBox[{"1", "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sow", "[", "dflection", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "s", "]"}], "/.", 
           RowBox[{"solx", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"y", "[", "s", "]"}], "/.", 
           RowBox[{"soly", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", "Dashed", "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.771602032013565*^9, 3.77160208441637*^9}, {
   3.7716022221750107`*^9, 3.77160224760894*^9}, {3.771602306112281*^9, 
   3.771602315953994*^9}, 3.771677440196824*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"1319a9b2-614e-4ebf-9c65-9601c6ad315d"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[Pi]", "2"], "//", "N"}]], "Input",
 CellChangeTimes->{{3.777806064187646*^9, 3.7778060680199947`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"f0a3816c-cd14-4b20-8432-10bf095f830c"],

Cell[BoxData[
 RowBox[{"PAna", "[", "9.9", "]"}]], "Input",
 CellChangeTimes->{{3.771602351478746*^9, 3.771602353660776*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"6347902f-36d0-4802-9150-f29f8d8bf9b3"],

Cell[BoxData[
 RowBox[{"PAna", "[", "11", "]"}]], "Input",
 CellChangeTimes->{{3.771602069811326*^9, 3.7716020982960253`*^9}, {
  3.7716021354601297`*^9, 3.771602135522547*^9}, {3.771602326833737*^9, 
  3.7716023270090437`*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"0ad58dc7-3a4f-49ac-9a08-5e385fc96d6e"],

Cell[BoxData[
 RowBox[{"PAna", "[", "21", "]"}]], "Input",
 CellChangeTimes->{{3.771602348329954*^9, 3.771602348406625*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"dd4c66cc-3176-487f-844b-d4ab0576440e"],

Cell[BoxData[
 RowBox[{"Clear", "[", "P", "]"}]], "Input",
 CellChangeTimes->{{3.771603411375979*^9, 3.771603413900784*^9}, 
   3.77160347041425*^9},
 CellLabel->
  "In[196]:=",ExpressionUUID->"be8e509e-efcb-47a8-9d52-f16b45faab2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PShape", "[", "P_", "]"}], ":=", 
  RowBox[{"Reap", "@", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"solk", ",", "kn", ",", "soly", ",", "solx"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"solk", " ", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"EllipticK", "[", "k", "]"}], "-", 
          RowBox[{
           RowBox[{"Sqrt", "[", "P", "]"}], "/", "2"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0.1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kn", " ", "=", 
       RowBox[{"k", "/.", "solk"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "s_", "]"}], "=", 
       RowBox[{"2", 
        RowBox[{"ArcSin", "[", 
         RowBox[{
          RowBox[{"Sqrt", "[", "kn", "]"}], " ", 
          RowBox[{"JacobiSN", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"s", " ", 
              RowBox[{"Sqrt", "[", "P", "]"}]}], "+", 
             RowBox[{"EllipticK", "[", "kn", "]"}]}], ",", "kn"}], "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"solx", " ", "=", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x", "'"}], "[", "s", "]"}], "==", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
           RowBox[{"x", "[", "s", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"soly", "=", " ", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"y", "'"}], "[", "s", "]"}], "\[Equal]", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
           RowBox[{"y", "[", "s", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "[", "s_", "]"}], "=", 
       RowBox[{
        RowBox[{"-", "s"}], "+", 
        RowBox[{
         FractionBox["2", 
          RowBox[{"Sqrt", "[", "P", "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"EllipticE", "[", 
            RowBox[{
             RowBox[{"JacobiAmplitude", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"s", " ", 
                 RowBox[{"Sqrt", "[", "P", "]"}]}], "+", 
                RowBox[{"EllipticK", "[", "kn", "]"}]}], ",", "kn"}], "]"}], 
             ",", "kn"}], "]"}], "-", 
           RowBox[{"EllipticE", "[", 
            RowBox[{
             RowBox[{"JacobiAmplitude", "[", 
              RowBox[{
               RowBox[{"EllipticK", "[", "kn", "]"}], ",", "kn"}], "]"}], ",",
              "kn"}], "]"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"y", "[", "s_", "]"}], "=", 
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        FractionBox[
         RowBox[{
          RowBox[{"Sqrt", "[", "kn", "]"}], " "}], 
         RowBox[{"Sqrt", "[", "P", "]"}]], 
        RowBox[{"JacobiCN", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s", " ", 
            RowBox[{"Sqrt", "[", "P", "]"}]}], "+", 
           RowBox[{"EllipticK", "[", "kn", "]"}]}], ",", "kn"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dflection", " ", "=", " ", 
       RowBox[{
        RowBox[{"y", "[", "s", "]"}], "/.", 
        RowBox[{"s", "\[Rule]", 
         RowBox[{"1", "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sow", "[", "dflection", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{"x", "[", "s", "]"}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "6"}]]}], "]"}], ",", 
          RowBox[{"y", "[", "s", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", "Dashed", "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.771603036801559*^9, 3.7716032607893457`*^9}, {
   3.7716033055339823`*^9, 3.771603349125113*^9}, {3.771603407480732*^9, 
   3.771603450353359*^9}, {3.771603499588673*^9, 3.7716035051971188`*^9}, {
   3.7716040311744003`*^9, 3.7716040314070387`*^9}, 3.771604175209407*^9, {
   3.7716043285705547`*^9, 3.771604419210136*^9}, {3.771604463934946*^9, 
   3.7716044689102077`*^9}, {3.771604550321267*^9, 3.771604582110272*^9}, {
   3.771604631600337*^9, 3.7716046448542643`*^9}, {3.771677547164069*^9, 
   3.771677595197013*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"53c57faa-7361-4aa9-8602-e3020cebd8b4"],

Cell[BoxData[
 RowBox[{"PShape", "[", "11", "]"}]], "Input",
 CellChangeTimes->{{3.771603271914851*^9, 3.7716032744335003`*^9}, {
  3.7716035545436296`*^9, 3.7716035547290916`*^9}, {3.771603969691073*^9, 
  3.771603986956888*^9}, {3.771604039555244*^9, 3.7716040855642223`*^9}, {
  3.771604179188035*^9, 3.7716042017205963`*^9}, {3.77160424050464*^9, 
  3.771604260923225*^9}, {3.7716043008490057`*^9, 3.771604309349481*^9}, {
  3.771604424147088*^9, 3.7716044251242228`*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"8175582d-05b8-403d-930e-2fad441a10f2"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"\[Theta]", ",", "x", ",", "y"}], "]"}]], "Input",
 CellChangeTimes->{{3.771677638866482*^9, 3.771677661490485*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"d844674e-9174-4fa5-8373-888a3156b615"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MMSFull", "[", "P0_", "]"}], ":=", 
  RowBox[{"Reap", "@", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", " ", "=", " ", "P0"}], ",", "solMM", ",", "MM\[Theta]2", 
       ",", "solx", ",", "soly", ",", "dflection"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"solMM", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[Theta]", "''"}], "[", "s", "]"}], "+", 
             RowBox[{"P", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}]}], "\[Equal]", 
            "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "'"}], "[", "1", "]"}], "\[Equal]", "0"}]}], 
          "}"}], ",", 
         RowBox[{"\[Theta]", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"solx", " ", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "'"}], "[", "s", "]"}], "==", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"\[Theta]", "[", "s", "]"}], "/.", 
              RowBox[{"solMM", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"x", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"soly", "=", " ", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"y", "'"}], "[", "s", "]"}], "\[Equal]", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Theta]", "[", "s", "]"}], "/.", 
              RowBox[{"solMM", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"y", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dflection", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", "s", "]"}], "/.", 
         RowBox[{"soly", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
        RowBox[{"s", "\[Rule]", 
         RowBox[{"1", "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sow", "[", "dflection", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "s", "]"}], "/.", 
           RowBox[{"solx", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"y", "[", "s", "]"}], "/.", 
           RowBox[{"soly", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Dashed", ",", 
           RowBox[{
            RowBox[{"ColorData", "[", "2", "]"}], "[", "1", "]"}], ",", 
           RowBox[{"Thickness", "[", "0.003", "]"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellLabel->
  "In[209]:=",ExpressionUUID->"95d78800-c73d-4019-9ece-36e42112ea01"],

Cell[BoxData[
 RowBox[{"MMSFull", "[", "11", "]"}]], "Input",
 CellChangeTimes->{{3.771677614499642*^9, 3.771677624319894*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"488630b2-a50c-4016-9778-ad862b80de56"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.771677868911511*^9},ExpressionUUID->"4271fcad-b0a9-4e18-954f-\
3c8b7ad394b5"],

Cell[BoxData[
 RowBox[{"MMSFull", "[", "9.9", "]"}]], "Input",
 CellChangeTimes->{{3.7716778664456987`*^9, 3.7716778667929573`*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"4339f635-beea-41b8-8cd7-895adcf82f91"]
},
WindowSize->{1280, 1330},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 173, 3, 35, "Text",ExpressionUUID->"faef9ad5-1fce-47ba-a23c-49e1964b1d52"],
Cell[734, 25, 744, 20, 52, "Input",ExpressionUUID->"a4600c7f-a3ec-4754-96f7-17c1cd975ef9"],
Cell[1481, 47, 863, 25, 30, "Input",ExpressionUUID->"c083e4b3-dbb0-434d-b79a-60ad0a735e01"],
Cell[2347, 74, 373, 9, 30, "Input",ExpressionUUID->"97d4a400-0c36-4a7c-b16d-c880540325f6"],
Cell[2723, 85, 334, 8, 30, "Input",ExpressionUUID->"0b0d5aaf-d4f1-4971-ac6e-0dacf94702aa"],
Cell[3060, 95, 780, 22, 73, "Input",ExpressionUUID->"9e0acb97-15d2-43ba-81cd-2aa990867155"],
Cell[3843, 119, 332, 8, 30, "Input",ExpressionUUID->"d7b78138-4c08-415d-834b-9358b14d8b68"],
Cell[4178, 129, 1353, 40, 108, "Input",ExpressionUUID->"cae0ff82-c32e-438f-bcd3-10feaa6f6b6f"],
Cell[5534, 171, 853, 20, 30, "Input",ExpressionUUID->"06b046e0-4064-4164-9724-4821b7b41253"],
Cell[6390, 193, 351, 10, 30, "Input",ExpressionUUID->"f66fec67-c8c1-49ee-9e50-0f295e10c765"],
Cell[6744, 205, 328, 8, 30, "Input",ExpressionUUID->"fe7bfa7f-b800-4c26-8779-00f9e7ac67b7"],
Cell[7075, 215, 3573, 100, 265, "Input",ExpressionUUID->"99125f90-cf86-4dc4-8fa7-751c2a9cf474"],
Cell[10651, 317, 3808, 99, 220, "Input",ExpressionUUID->"1319a9b2-614e-4ebf-9c65-9601c6ad315d"],
Cell[14462, 418, 224, 4, 30, "Input",ExpressionUUID->"f0a3816c-cd14-4b20-8432-10bf095f830c"],
Cell[14689, 424, 208, 4, 30, "Input",ExpressionUUID->"6347902f-36d0-4802-9150-f29f8d8bf9b3"],
Cell[14900, 430, 311, 6, 30, "Input",ExpressionUUID->"0ad58dc7-3a4f-49ac-9a08-5e385fc96d6e"],
Cell[15214, 438, 207, 4, 30, "Input",ExpressionUUID->"dd4c66cc-3176-487f-844b-d4ab0576440e"],
Cell[15424, 444, 232, 5, 30, "Input",ExpressionUUID->"be8e509e-efcb-47a8-9d52-f16b45faab2f"],
Cell[15659, 451, 5469, 140, 343, "Input",ExpressionUUID->"53c57faa-7361-4aa9-8602-e3020cebd8b4"],
Cell[21131, 593, 559, 9, 30, "Input",ExpressionUUID->"8175582d-05b8-403d-930e-2fad441a10f2"],
Cell[21693, 604, 250, 5, 30, "Input",ExpressionUUID->"d844674e-9174-4fa5-8373-888a3156b615"],
Cell[21946, 611, 4006, 108, 199, "Input",ExpressionUUID->"95d78800-c73d-4019-9ece-36e42112ea01"],
Cell[25955, 721, 210, 4, 30, "Input",ExpressionUUID->"488630b2-a50c-4016-9778-ad862b80de56"],
Cell[26168, 727, 128, 3, 30, "Input",ExpressionUUID->"4271fcad-b0a9-4e18-954f-3c8b7ad394b5"],
Cell[26299, 732, 215, 4, 30, "Input",ExpressionUUID->"4339f635-beea-41b8-8cd7-895adcf82f91"]
}
]
*)

